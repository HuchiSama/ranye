(this.webpackJsonpzhihu=this.webpackJsonpzhihu||[]).push([[0],{108:function(e,t,c){},118:function(e,t,c){},173:function(e,t,c){},174:function(e,t,c){},222:function(e,t,c){},297:function(e,t,c){},298:function(e,t,c){},319:function(e,t,c){"use strict";c.r(t);var n=c(1),s=c(0),a=c.n(s),i=c(32),r=c.n(i),o=(c(118),c(173),c(4)),l=c(2),j=(c(174),c(329)),u=c(330),d=c(331),b=c(332),m=c(333),O=c(334),f=c(335),h=c(336),p=c(337),x=c(338),v=c(62),g=c(13),y=c(8),C=c.n(y),k={getInitial:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))},toSign:function(e,t){return Object(g.a)(e,(function(e){e.sign=t.sign}))},toChat:function(e,t){return Object(g.a)(e,(function(e){e.chat=t.chat}))}};var N=Object(v.a)((function(e,t){return t.type in k?k[t.type](e,t):e}),{question:!1,sign:!0,invitedList:[],chat:!1,chatList:[],cares:{}}),I={formRedirect:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))},sucessSignup:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))},toSignin:function(e,t){return Object(g.a)(e,(function(e){e.sucessSignup=t.sucessSignup,e.form="signin",e.captcha=!0,e.protocol="\u672a\u6ce8\u518c\u624b\u673a\u9a8c\u8bc1\u540e\u81ea\u52a8\u767b\u5f55\uff0c\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",e.buttonText="\u767b\u5f55",e.other=!0}))}};var S=Object(v.a)((function(e,t){return t.type in I?I[t.type](e,t):e}),{form:"signin",captcha:!0,protocol:"\u672a\u6ce8\u518c\u624b\u673a\u9a8c\u8bc1\u540e\u81ea\u52a8\u767b\u5f55\uff0c\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",buttonText:"\u767b\u5f55",other:!0}),A={postQuestion:function(e,t){return Object(g.a)(e,(function(e){e.question=t.question,e.postCount=t.postCount,e.posts=t.posts}))},question:function(e,t){return Object(g.a)(e,(function(e){e.question=t.question}))},getData:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))},toAttention:function(e,t){return Object(g.a)(e,(function(e){e.attention[t.postId]?(C.a.post("/api/attention/",{qusId:t.postId,createdAt:Date.now(),type:"revoke"}),e.posts.forEach((function(e){e.postId===t.postId&&(e.qusLike=t.like-1)})),e.attention[t.postId]=!1):(C.a.post("/api/attention/",{qusId:t.postId,createdAt:Date.now(),type:"attention"}),e.posts.forEach((function(e){e.postId===t.postId&&(e.qusLike=t.like+1)})),e.attention[t.postId]=!0)}))},poorButton:function(e,t){return Object(g.a)(e,(function(e){e.poors[t.postId]?(C.a.post("/api/attention/",{qusId:t.postId,type:"revoke",style:"poor",createdAt:Date.now()}),e.poors[t.postId]=!1,e.posts.forEach((function(e){e.postId===t.postId&&(e.poor=t.poor-1)}))):(C.a.post("/api/attention/",{qusId:t.postId,type:"attention",style:"poor",createdAt:Date.now()}),e.poors[t.postId]=!0,e.posts.forEach((function(e){e.postId===t.postId&&(e.poor=t.poor+1)})))}))},deletePost:function(e,t){return Object(g.a)(e,(function(e){e.postCount=t.postCount,e.posts=t.posts}))},collect:function(e,t){return Object(g.a)(e,(function(e){e.collect_quesActive[t.collectId]?(C.a.post("/api/collect/",{id:t.id,collectId:t.collectId,type:"revoke",style:"question"}),e.collect_quesActive[t.collectId]=!1):(C.a.post("/api/collect/",{id:t.id,collectId:t.collectId,type:"collect",style:"question"}),e.collect_quesActive[t.collectId]=!0)}))},favorite:function(e,t){return Object(g.a)(e,(function(e){e.favoriteQues[t.favoriteId]?(C.a.post("/api/favorite/",{id:t.id,favoriteId:t.favoriteId,type:"revoke",style:"question"}),e.favoriteQues[t.favoriteId]=!1):(C.a.post("/api/favorite/",{id:t.id,favoriteId:t.favoriteId,type:"favorite",style:"question"}),e.favoriteQues[t.favoriteId]=!0)}))},hoverAvatar:function(e,t){return Object(g.a)(e,(function(e){e.hover=t.hover}))}};var E=Object(v.a)((function(e,t){return t.type in A?A[t.type](e,t):e}),{question:!1,hover:!1}),w={writeAnswer:function(e,t){return Object(g.a)(e,(function(e){e.writeAnswer=t.writeAnswer}))},getInitial:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))},postAnswer:function(e,t){return Object(g.a)(e,(function(e){e.commenterInfo=t.commenterInfo,e.writeAnswer=!1}))},toAttention:function(e,t){return Object(g.a)(e,(function(e){t.attention?(C.a.post("/api/attention/",{qusId:t.pageId,type:"attention",createdAt:Date.now()}),e.attention=t.attention,e.attentionLength++):(C.a.post("/api/attention/",{qusId:t.pageId,type:"revoke",createdAt:Date.now()}),e.attention=t.attention,e.attentionLength--)}))},likeComment:function(e,t){return Object(g.a)(e,(function(e){e.likes[t.commentId]?(C.a.post("/api/likeComment/",{commentId:t.commentId,type:"revoke",createdAt:Date.now()}),e.commenterInfo.forEach((function(e){e.commentId===t.commentId&&(e.like=t.like-1)})),e.poster?e.poster.agree-=1:e.userInfo.agree-=1,e.likes[t.commentId]=!1):(C.a.post("/api/likeComment/",{commentId:t.commentId,type:"active",createdAt:Date.now()}),e.commenterInfo.forEach((function(e){e.commentId===t.commentId&&(e.like=t.like+1)})),e.poster?e.poster.agree+=1:e.userInfo.agree+=1,e.likes[t.commentId]=!0)}))},poorButton:function(e,t){return Object(g.a)(e,(function(e){e.commentPoors[t.commentId]?(C.a.post("/api/likeComment/",{commentId:t.commentId,type:"revoke",style:"poor",createdAt:Date.now()}),e.commenterInfo.forEach((function(e){e.commentId===t.commentId&&(e.poor=t.poor-1)})),e.commentPoors[t.commentId]=!1):(C.a.post("/api/likeComment/",{commentId:t.commentId,type:"active",style:"poor",createdAt:Date.now()}),e.commenterInfo.forEach((function(e){e.commentId===t.commentId&&(e.poor=t.poor+1)})),e.commentPoors[t.commentId]=!0)}))},deleteComment:function(e,t){return Object(g.a)(e,(function(e){e.commenterInfo=t.comments}))},collect:function(e,t){return Object(g.a)(e,(function(e){e.collect_commActive[t.collectId]?(C.a.post("/api/collect/",{id:t.id,collectId:t.collectId,type:"revoke",style:"comment"}),e.collect_commActive[t.collectId]=!1):(C.a.post("/api/collect/",{id:t.id,collectId:t.collectId,type:"collect",style:"comment"}),e.collect_commActive[t.collectId]=!0)}))},favorite:function(e,t){return Object(g.a)(e,(function(e){e.favoriteComment[t.favoriteId]?(C.a.post("/api/favorite/",{id:t.id,favoriteId:t.favoriteId,type:"revoke",style:"comment"}),e.favoriteComment[t.favoriteId]=!1):(C.a.post("/api/favorite/",{id:t.id,favoriteId:t.favoriteId,type:"favorite",style:"comment"}),e.favoriteComment[t.favoriteId]=!0)}))},ansCommentList:function(e,t){return Object(g.a)(e,(function(e){e.commenterInfo.forEach((function(e){e.commentId===t.id&&e.ansComments++}))}))},invite:function(e,t){return Object(g.a)(e,(function(e){e.invite=t.invite}))},upDateInvite:function(e,t){return Object(g.a)(e,(function(e){e.inviteList=t.inviteList}))}};var L=Object(v.a)((function(e,t){return t.type in w?w[t.type](e,t):e}),{writeAnswer:!1,invite:!1,inviteList:[]}),D={getInitial:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))},editState:function(e,t){return Object(g.a)(e,(function(e){e.edit=t.edit}))},editUserInfo:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e.userInfo[c]=t[c]}))},editEnd:function(e,t){return Object(g.a)(e,(function(e){e.edit=t.edit}))},updateActive:function(e,t){return Object(g.a)(e,(function(e){e.attention=t.attention,e.poors=t.poors}))},activeSwitch:function(e,t){return Object(g.a)(e,(function(e){e.active=t.active}))},careActive:function(e,t){return Object(g.a)(e,(function(e){e.careActive=t.careActive}))},collectActive:function(e,t){return Object(g.a)(e,(function(e){e.collectActive=t.collectActive}))}};var q=Object(v.a)((function(e,t){return t.type in D?D[t.type](e,t):e}),{writeAnswer:!1,edit:!1,question:!1,active:0,careActive:0,collectActive:0}),U={updateCare:function(e,t){return Object(g.a)(e,(function(e){var c=e.myCares.length;if(0!==c)for(var n=0;n<c;n++){if(e.myCares[n].careId===t.id){e.myCares[n].careId=null;break}n===c-1&&(e.myCares[c]={careId:t.id})}else e.myCares[c]={careId:t.id}}))},getCare:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)e[c]=t[c]}))}};var M=Object(v.a)((function(e,t){return t.type in U?U[t.type](e,t):e}),{myCares:[]}),F={getInitial:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)"id"===c||"ansCommentList"===c?e.ansCommentList[t.id]=t.ansCommentList:e[c]=t[c]}))},postComment:function(e,t){return Object(g.a)(e,(function(e){e.ansCommentList[t.id]=t.newList}))},likeAnsComment:function(e,t){return Object(g.a)(e,(function(e){e.myLikeAnsComment[t.id]?(C.a.post("/api/ansCommentLike/".concat(t.id),{style:"like",type:"revoke"}),e.ansCommentList[t.commentId].forEach((function(e){e.ansCommentId===t.id&&(e.like-=1)})),e.myLikeAnsComment[t.id]=!1):(C.a.post("/api/ansCommentLike/".concat(t.id),{style:"like",type:"active"}),e.ansCommentList[t.commentId].forEach((function(e){e.ansCommentId===t.id&&(e.like+=1)})),e.myLikeAnsComment[t.id]=!0)}))},poorAnsComment:function(e,t){return Object(g.a)(e,(function(e){e.myPoorAnsComment[t.id]?(C.a.post("/api/ansCommentLike/".concat(t.id),{style:"poor",type:"revoke"}),e.ansCommentList[t.commentId].forEach((function(e){e.ansCommentId===t.id&&(e.poor-=1)})),e.myPoorAnsComment[t.id]=!1):(C.a.post("/api/ansCommentLike/".concat(t.id),{style:"poor",type:"active"}),e.ansCommentList[t.commentId].forEach((function(e){e.ansCommentId===t.id&&(e.poor+=1)})),e.myPoorAnsComment[t.id]=!0)}))},postEndComment:function(e,t){return Object(g.a)(e,(function(e){e.endCommentList[t.id]=t.newList,e.ansCommentList[t.commentId].forEach((function(e,c){e.ansCommentId===t.id&&(e.endComment+=1)}))}))},getEndCommentList:function(e,t){return Object(g.a)(e,(function(e){for(var c in t)"id"===c||"endCommentList"===c?e.endCommentList[t.id]=t.endCommentList:e[c]=t[c]}))},likeEndComment:function(e,t){return Object(g.a)(e,(function(e){e.myLikeEndComment[t.id]?(C.a.post("/api/endCommentLike/".concat(t.id),{style:"like",type:"revoke"}),e.endCommentList[t.ansCommentId].forEach((function(e){e.endCommentId===t.id&&(e.like-=1)})),e.myLikeEndComment[t.id]=!1):(C.a.post("/api/endCommentLike/".concat(t.id),{style:"like",type:"active"}),e.endCommentList[t.ansCommentId].forEach((function(e){e.endCommentId===t.id&&(e.like+=1)})),e.myLikeEndComment[t.id]=!0)}))},poorEndComment:function(e,t){return Object(g.a)(e,(function(e){e.myPoorEndComment[t.id]?(C.a.post("/api/endCommentLike/".concat(t.id),{style:"poor",type:"revoke"}),e.endCommentList[t.ansCommentId].forEach((function(e){e.endCommentId===t.id&&(e.poor-=1)})),e.myPoorEndComment[t.id]=!1):(C.a.post("/api/endCommentLike/".concat(t.id),{style:"poor",type:"active"}),e.endCommentList[t.ansCommentId].forEach((function(e){e.endCommentId===t.id&&(e.poor+=1)})),e.myPoorEndComment[t.id]=!0)}))}};var T=Object(v.a)((function(e,t){return t.type in F?F[t.type](e,t):e}),{ansCommentList:{},endComment:!1,endCommentList:{}}),H=c(75),P=c(27),Y=c(16),z=c(17),R=c(21),_=c(29),Q=c(9),B=function(e){Object(R.a)(c,e);var t=Object(_.a)(c);function c(e){var n;return Object(Y.a)(this,c),(n=t.call(this)).signTo=function(e){e.preventDefault();var t=e.target;if("signin"===n.props.form){var c={name:t.name.value,password:t.password.value,captcha:t.captcha.value};C.a.post("/api/clearCookie"),C.a.post("/api/login",c).then((function(e){0===e.data?(document.querySelector(".captcha").click(),n.errRef.current.innerHTML="\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"):1===e.data?"/sign"===window.location.pathname?n.props.history.push("/"):(N.dispatch({type:"toSign",sign:!0}),window.location.replace("")):(document.querySelector(".captcha").click(),n.errRef.current.innerHTML="\u9a8c\u8bc1\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165")})).catch(console.log)}else{if(t.password.value!==t.nextPassword.value)return n.errRef.current.innerHTML="\u5bc6\u7801\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165";var s={name:t.name.value.trim(),password:t.password.value.trim(),email:t.email.value.trim()};if(!s.name||!s.password||!s.email)return n.errRef.current.innerHTML="\u4e0d\u80fd\u8f93\u5165\u7a7a\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165";if(n.props.accQuery)return n.errRef.current.innerHTML="\u7528\u6237\u540d\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165";if(n.props.emailQuery)return n.errRef.current.innerHTML="\u90ae\u7bb1\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165";C.a.post("/api/sign_up",s).then((function(e){e.data?(S.dispatch({type:"sucessSignup",sucessSignup:!0}),setTimeout((function(){document.querySelector(".success").classList.remove("suc-transition")}),200),setTimeout((function(){document.querySelector(".success img").classList.add("img-cslc"),document.querySelector(".success label").classList.remove("label-visi")}),3e3)):n.errRef.current.innerHTML="\u6ce8\u518c\u5931\u8d25\uff0c\u8bf7\u518d\u6b21\u5c1d\u8bd5"})).catch((function(){n.errRef.current.innerHTML="\u6ce8\u518c\u5931\u8d25\uff0c\u8bf7\u518d\u6b21\u5c1d\u8bd5"}))}},n.toSignUp=function(e){e.preventDefault(),S.dispatch({type:"formRedirect",form:"signup",captcha:!1,other:!1,protocol:"\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",buttonText:"\u6ce8\u518c"})},n.toSignIn=function(e){e.preventDefault(),S.dispatch({type:"formRedirect",form:"signin",captcha:2,other:!0,protocol:"\u672a\u6ce8\u518c\u624b\u673a\u9a8c\u8bc1\u540e\u81ea\u52a8\u767b\u5f55\uff0c\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",buttonText:"\u767b\u5f55"})},n.state=S.getState(),n.props=e,n.errRef=Object(s.createRef)(),n}return Object(z.a)(c,null,[{key:"footer",value:function(e){var t=Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("hr",{className:"other-hr"}),Object(n.jsxs)("div",{className:"other-Account",children:[Object(n.jsx)("span",{children:"\u5176\u4ed6\u8d26\u53f7\u767b\u9646"}),Object(n.jsx)("span",{children:"\u5e7f\u544a\u4f4d\u62db\u79df"}),Object(n.jsx)("span",{children:"\u5e7f\u544a\u4f4d\u62db\u79df"})]})]});return Object(n.jsx)(n.Fragment,{children:e.other&&t})}}]),Object(z.a)(c,[{key:"componentDidMount",value:function(){var e=this;window.onclick=function(){e.errRef.current.innerHTML=""}}},{key:"componentWillUnmount",value:function(){window.onclick=null}},{key:"render",value:function(){var e=this.props,t=e.children.props.children;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("form",{action:"/api/login",method:"post",onSubmit:this.signTo,children:[t.filter((function(e){return"div"!==e.type})),Object(n.jsx)("div",{className:"redirector",children:"signin"===e.form?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(Q.b,{to:"/sign_up",className:"zhuce",onClick:this.toSignUp,children:"\u6ce8\u518c\u65b0\u7528\u6237"}),Object(n.jsx)(Q.b,{to:"/lossPas",className:"lossPas",children:"\u5fd8\u8bb0\u5bc6\u7801\uff1f"})]}):Object(n.jsx)(Q.b,{to:"/sign",className:"zhuce",onClick:this.toSignIn,children:"\u8fd4\u56de\u767b\u9646\u754c\u9762"})}),t.filter((function(e){return"div"===e.type})),Object(n.jsx)("span",{className:"signin"===e.form?"sub-error":"lossPas sub-error",ref:this.errRef}),Object(n.jsx)("button",{type:"submit",className:"submit",children:e.buttonText}),Object(n.jsx)("span",{className:"xieyi",children:this.state.protocol})]}),Object(n.jsx)(c.footer,{xieyi:e.xieyi,other:e.other})]})}}]),c}(a.a.Component),J=Object(P.h)(B);function W(e){var t=Object(s.useState)(S.getState()),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(!1),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useCallback)((function(e){"signin"===("\u7528\u6237\u767b\u5f55"===e.target.textContent?"signin":"signup")?S.dispatch({type:"formRedirect",form:"signin",captcha:2,other:!0,protocol:"\u672a\u6ce8\u518c\u624b\u673a\u9a8c\u8bc1\u540e\u81ea\u52a8\u767b\u5f55\uff0c\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",buttonText:"\u767b\u5f55"}):S.dispatch({type:"formRedirect",form:"signup",captcha:!1,other:!1,protocol:"\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",buttonText:"\u6ce8\u518c"})}),[]);Object(s.useEffect)((function(){var e=S.subscribe((function(){return i(S.getState())}));return function(){return e()}}),[]);var h=Object(s.useCallback)((function(e){e.target.src="/api/captcha?t=".concat(Date.now())}),[]),p=Object(s.useCallback)((function(e){C.a.post("/api/user-query/",{name:e.target.value}).then((function(e){0===e.data?u(!0):u(!1)}))}),[]),x=Object(s.useCallback)((function(e){C.a.post("/api/email-query/",{email:e.target.value}).then((function(e){0===e.data?O(!0):O(!1)}))}),[]);return Object(n.jsxs)("div",{className:"outer",children:[Object(n.jsxs)("div",{className:"form-header",children:[Object(n.jsx)("label",{className:"signin"===a.form?"form-action":"",onClick:f,children:"\u7528\u6237\u767b\u5f55"}),Object(n.jsx)("label",{className:"signup"===a.form?"form-action signup-label":"signup-label",onClick:f,children:"\u6ce8\u518c\u8d26\u53f7"})]}),Object(n.jsx)("hr",{}),Object(n.jsx)(J,{captcha:a.captcha,other:a.other,form:a.form,xieyi:a.captcha,buttonText:a.buttonText,accQuery:j,emailQuery:m,children:"signin"===a.form?Object(n.jsxs)("div",{children:[Object(n.jsx)("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u767b\u5f55\u8d26\u53f7",className:"name",name:"name"}),Object(n.jsx)("input",{type:"password",placeholder:"\u5bc6\u7801",className:"password",name:"password"}),Object(n.jsxs)("div",{name:"captcha-div",children:[Object(n.jsx)("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",className:"captcha-input",name:"captcha"}),Object(n.jsx)("img",{src:"/api/captcha?t=".concat(Date.now()),title:"\u70b9\u51fb\u6362\u4e00\u5f20",className:"captcha",onClick:h,alt:"captcha"})]})]}):Object(n.jsxs)("div",{children:[Object(n.jsx)("input",{type:"text",placeholder:"\u8bf7\u8f93\u5165\u6ce8\u518c\u8d26\u53f7",className:"name",name:"name",onChange:p}),j&&Object(n.jsx)("label",{className:"user-query"}),Object(n.jsx)("input",{type:"email",placeholder:"\u7ed1\u5b9a\u7535\u5b50\u90ae\u7bb1",className:"email",name:"email",onChange:x}),m&&Object(n.jsx)("label",{className:"email-query"}),Object(n.jsx)("input",{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",className:"password",name:"password"}),Object(n.jsx)("input",{type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801",className:"password",name:"nextPassword"})]})})]})}var G=c(12),V=c.n(G),K=c(326),$=c(327),X=c(328),Z=c(324),ee=c(102),te=Z.a.TextArea,ce=function(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=e.careInfo,j=void 0===r?{}:r,u=Object(s.useState)(!1),d=Object(l.a)(u,2),b=d[0],m=d[1],O=Object(s.useState)(N.getState()),f=Object(l.a)(O,2),h=f[0],p=f[1];Object(s.useEffect)((function(){var e=N.subscribe((function(){return p(N.getState())}));return function(){return e()}}),[]),Object(s.useEffect)((function(){if(a){var e=document.querySelector(".recare");e.onmouseenter=function(){e.childNodes[1].innerText="\u53d6\u6d88"},e.onmouseleave=function(){e.childNodes[1].innerText="\u5df2\u5173\u6ce8"}}return function(){a&&(e.onmouseenter=null,e.onmouseleave=null)}}),[a]),Object(s.useEffect)((function(){C.a.get("/api/care").then((function(e){var t=e.data;M.dispatch(Object(o.a)({type:"getCare"},t))})).catch((function(e){}));var e=M.subscribe((function(){i(Array.from(M.getState().myCares).some((function(e){return e.careId===j.userId})))}));return function(){return e()}}),[j]);var x=Object(s.useCallback)((function(){void 0!==h.cookieUser?(M.dispatch({type:"updateCare",id:j.userId}),C.a.post("/api/care",{type:a?"reCare":"toCare",careId:j.userId}).catch((function(e){401===e.response.status&&N.dispatch({type:"toSign",sign:!1})}))):N.dispatch({type:"toSign",sign:!1})}),[a,j,h]),v=Object(s.useCallback)((function(){void 0!==h.cookieUser?m(!b):N.dispatch({type:"toSign",sign:!1})}),[b,h]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("ul",{className:"poster-interactive",children:[a?Object(n.jsxs)("li",{onClick:x,className:"recare",children:[Object(n.jsx)(K.a,{}),Object(n.jsx)("span",{children:"\u5df2\u5173\u6ce8"})]}):Object(n.jsxs)("li",{onClick:x,children:[Object(n.jsx)(K.a,{}),Object(n.jsx)("span",{children:"\u5173\u6ce8\u4ed6"})]}),Object(n.jsxs)("li",{onClick:v,children:[Object(n.jsx)($.a,{}),"\u53d1\u79c1\u4fe1"]})]}),b&&Object(n.jsx)(ne,{targetInfo:j,setChat:m,state:h})]})};function ne(e){var t=e.targetInfo,c=e.setChat,a=e.state,i=Object(s.useState)(""),r=Object(l.a)(i,2),o=r[0],j=r[1],u=Object(s.useState)([]),d=Object(l.a)(u,2),b=d[0],m=d[1],O=Object(s.useState)(null),f=Object(l.a)(O,2),h=f[0],p=f[1];Object(s.useEffect)((function(){null===h&&p(new WebSocket("ws://47.111.233.71:8080/targetId=".concat(t.userId,"&&userId=").concat(a.userInfo.userId)))}),[t,a,h]);var x=Object(s.useCallback)((function(){""!==o&&(h.send(JSON.stringify([{content:o,targetName:t.name,targetId:t.userId,targetAvatar:t.avatar}])),j(""))}),[o,t,h]);Object(s.useEffect)((function(){h&&(h.onopen=function(e){console.log("WebSocket opened!")},h.onclose=function(){console.log("WebSocket closed!")},h.onmessage=function(e){var t=JSON.parse(e.data);t=t.flat(),console.log(t),m(t)})}),[h]);var v=Object(s.useCallback)((function(e){j(e.target.value)}),[]),g=Object(s.useCallback)((function(){c(!1),h.close()}),[h,c]);Object(s.useEffect)((function(){document.querySelector(".chat-section").scrollTop=document.querySelector(".chat-section-ul").offsetHeight}),[b]);var y=Object(s.useCallback)((function(e){e.shiftKey||13!==e.keyCode||(e.preventDefault(),document.querySelector(".chat-edit-footer button").click())}),[]);return Object(n.jsx)("div",{className:"chat-outer",style:{width:"".concat(window.innerWidth,"px"),height:"".concat(window.innerHeight,"px")},children:Object(n.jsxs)("div",{className:"chat-container",children:[Object(n.jsxs)("div",{className:"chat-user-head",children:[Object(n.jsx)("label",{onClick:g,children:Object(n.jsx)(X.a,{})}),Object(n.jsx)("h2",{children:t.name})]}),Object(n.jsx)("div",{className:"chat-section",children:Object(n.jsx)("ul",{className:"chat-section-ul",children:b.map((function(e,c){if(e.targetName!==a.cookieUser){var i=V()(Date.now()).format("YY"),r=V()(1*e.createdAt).format("YY");return Object(n.jsxs)(s.Fragment,{children:[Object(n.jsx)("li",{className:"chat-time",children:(0===c||e.createdAt-b[c-1].createdAt>=18e4)&&Object(n.jsx)("span",{children:1*i>1*r?V()(1*e.createdAt).format("YY-MM-DD HH:mm:ss"):V()(1*e.createdAt).format("MM-DD HH:mm:ss")})}),Object(n.jsxs)("li",{className:"chat-section-me",children:[Object(n.jsx)("p",{className:"chat-msg-content",children:e.content}),Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(e.userAvatar,")")},className:"chat-msg-avatar"})]},e.createdAt)]},e.createdAt)}var o=V()(Date.now()).format("YY"),l=V()(1*e.createdAt).format("YY");return Object(n.jsxs)(s.Fragment,{children:[Object(n.jsx)("li",{className:"chat-time",children:(0===c||e.createdAt-b[c-1].createdAt>=18e4)&&Object(n.jsx)("span",{children:1*o>1*l?V()(1*e.createdAt).format("YY-MM-DD HH:mm:ss"):V()(1*e.createdAt).format("MM-DD HH:mm:ss")})}),Object(n.jsxs)("li",{className:"chat-section-target",children:[Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(t.avatar,")")},className:"chat-msg-avatar"}),Object(n.jsx)("p",{className:"chat-msg-content",children:e.content})]},e.createdAt)]},e.createdAt)}))})}),Object(n.jsxs)("div",{className:"chat-footer",children:[Object(n.jsx)("div",{className:"chat-edit",children:Object(n.jsx)(te,{rows:6,value:o,onChange:v,onKeyDown:y})}),Object(n.jsxs)("div",{className:"chat-edit-footer",children:[Object(n.jsx)("span",{children:"\u6309Enter \u53d1\u9001"}),Object(n.jsx)(ee.a,{type:"primary",onClick:x,children:"\u53d1\u9001"})]})]})]})})}c(108);function se(e){return Object(n.jsxs)("div",{className:"signup"===e.type?"signup-footer footer":"footer",children:[Object(n.jsx)("span",{children:" \xa9 2020 \u77e5\u4e4e\u4eac ICP \u8bc1 110745 \u53f7\u4eac ICP \u5907 13052560 \u53f7 - 1\u4eac\u516c\u7f51\u5b89\u5907 11010802010035 \u53f7\u51fa\u7248\u7269\u7ecf\u8425\u8bb8\u53ef\u8bc1"}),Object(n.jsx)("br",{}),Object(n.jsx)("span",{children:"\u4fb5\u6743\u4e3e\u62a5\u7f51\u4e0a\u6709\u5bb3\u4fe1\u606f\u4e3e\u62a5\u4e13\u533a\u513f\u7ae5\u8272\u60c5\u4fe1\u606f\u4e3e\u62a5\u4e13\u533a\u8fdd\u6cd5\u548c\u4e0d\u826f\u4fe1\u606f\u4e3e\u62a5\uff1a010-82716601 "})]})}function ae(){var e=Object(s.useState)({form:"signup",captcha:!1,other:!1,protocol:"\u6ce8\u518c\u5373\u4ee3\u8868\u540c\u610f\u300a\u77e5\u4e4e\u534f\u8bae\u300b\u300a\u9690\u79c1\u4fdd\u62a4\u6307\u5f15\u300b",buttonText:"\u6ce8\u518c",sucessSignup:!1}),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(s.useEffect)((function(){var e=S.subscribe((function(){return a(S.getState())}));return function(){return e()}})),Object(n.jsxs)("div",{className:"main",children:[c.sucessSignup&&Object(n.jsx)(ie,{props:c}),Object(n.jsx)("img",{src:"../images/login-top.png",alt:"logo",className:"logo"}),Object(n.jsx)(W,{state:c}),Object(n.jsx)(se,{type:"signup"})]})}function ie(e){var t=Object(s.useCallback)((function(e){e.preventDefault(),S.dispatch({type:"toSignin",sucessSignup:!1})}),[]);return Object(n.jsx)("div",{className:"success-bg",children:Object(n.jsxs)("div",{className:e.sucessSignup?"success":"suc-transition success",children:[Object(n.jsx)("img",{src:"/images/loading.gif",alt:"\u6ce8\u518c\u6210\u529f"}),Object(n.jsxs)("label",{className:"label-visi",children:[Object(n.jsx)("span",{children:"\u6ce8\u518c\u6210\u529f\uff01 "})," \u70b9\u51fb ",Object(n.jsx)(Q.b,{to:"/sign",onClick:t,children:"\u8fd4\u56de\u767b\u9646"})]})]})})}var re=function(e){var t=Object(s.useState)("none"),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(N.getState()||{}),m=Object(l.a)(r,2),O=m[0],f=m[1],h=function(){var e=Object(s.useState)(N.getState().invitedList||[]),t=Object(l.a)(e,2),c=t[0],n=t[1],a=Object(s.useState)(N.getState().byCareList||[]),i=Object(l.a)(a,2),r=i[0],j=i[1],u=Object(s.useState)(N.getState().byCommentLike||[]),d=Object(l.a)(u,2),b=d[0],m=d[1],O=Object(s.useState)(0),f=Object(l.a)(O,2),h=f[0],p=f[1],x=Object(s.useState)(!1),v=Object(l.a)(x,2),g=v[0],y=v[1];return Object(s.useEffect)((function(){C.a.get("/api/invite").then((function(e){var t=e.data;N.dispatch(Object(o.a)({type:"getInitial"},t))}))}),[]),Object(s.useEffect)((function(){var e=c.filter((function(e){return"view"!==e.status})).length,t=r.filter((function(e){return"view"!==e.status})).length,n=b.filter((function(e){return"view"!==e.status})).length;p(e+t+n)}),[c,r,b]),Object(s.useEffect)((function(){var e=N.subscribe((function(){n(N.getState().invitedList||[]),j(N.getState().byCareList||[]),m(N.getState().byCommentLike||[])}));return function(){return e()}}),[]),Object(s.useEffect)((function(){var e=document.querySelector(".nav-invited-outer"),t=function(e){y(!1)};function c(){window.addEventListener("click",t)}function n(){window.removeEventListener("click",t)}return e.addEventListener("mouseleave",c),e.addEventListener("mouseenter",n),function(){e.removeEventListener("mouseleave",c),e.removeEventListener("mouseenter",n)}}),[]),{invitePull:Object(s.useCallback)((function(e,t){var c=Object(l.a)(e,2),n=c[0],s=c[1];t.stopPropagation(),y(!g),n(!1),s("none"),C.a.post("/api/clear-invited"),p(0)}),[g]),inviteMsg:c,byCareMsg:r,byCommentMsg:b,msgSum:h,invited:g,setInvited:y}}(),p=h.invitePull,x=h.inviteMsg,v=h.byCareMsg,g=h.byCommentMsg,y=h.msgSum,k=h.invited,I=h.setInvited,A=function(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),n=c[0],a=c[1],i=Object(s.useState)(0),r=Object(l.a)(i,2),j=r[0],u=r[1],d=Object(s.useState)(N.getState().chatList),b=Object(l.a)(d,2),m=b[0],O=b[1];Object(s.useEffect)((function(){C.a.get("/api/chat-list").then((function(e){var t=e.data;N.dispatch(Object(o.a)({type:"getInitial"},t))})).catch((function(e){console.dir(e)}))}),[]),Object(s.useEffect)((function(){var e=N.subscribe((function(){return O(N.getState().chatList)}));return function(){return e()}}),[]);var f=Object(s.useCallback)((function(e,t){var c=Object(l.a)(e,2),s=c[0],i=c[1];t.stopPropagation(),s("none"),a(!n),i(!1),u(0)}),[n]);return Object(s.useEffect)((function(){e.cookieUser&&u(m.flat().filter((function(t){return"normal"===t.status&&t.userName!==e.cookieUser})).length)}),[m,e]),Object(s.useEffect)((function(){var e=document.querySelector(".nav-chat-outer"),t=function(e){a(!1)};function c(){window.addEventListener("click",t)}function n(){window.removeEventListener("click",t)}return e.addEventListener("mouseleave",c),e.addEventListener("mouseenter",n),function(){e.removeEventListener("mouseleave",c),e.removeEventListener("mouseenter",n)}}),[]),{chat:n,setChat:a,chatSum:j,chatList:m,chatPull:f}}(O),w=A.chat,L=A.chatSum,D=A.chatList,q=A.chatPull,U=A.setChat,M=Object(s.useState)(S.getState()),F=Object(l.a)(M,2),T=F[0],H=F[1];Object(s.useEffect)((function(){var e=S.subscribe((function(){return H(S.getState()||{})})),t=N.subscribe((function(){return f(N.getState()||{})}));return function(){t(),e()}}),[]);var P=Object(s.useCallback)((function(){void 0!==O.cookieUser?E.dispatch({type:"question",question:!0}):N.dispatch({type:"toSign",sign:!1})}),[O]);Object(s.useEffect)((function(){C.a.get("/api/nav-data").then((function(e){var t=e.data;N.dispatch(Object(o.a)({type:"getInitial"},t))}));var e=function(){i("none")};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[a]),Object(s.useEffect)((function(){if(!O.sign){function e(e){var t=document.querySelector(".user-not-sign");e.target===t&&N.dispatch({type:"toSign",sign:!0})}return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}}),[O]);var Y=Object(s.useCallback)((function(e,t){var c=Object(l.a)(e,2),n=c[0],s=c[1];t.stopPropagation(),i("none"===a?"block":"none"),n(!1),s(!1)}),[a]);return Object(s.useEffect)((function(){var t=document.querySelector(".nav-slider-outer");function c(c){"post"===e.page&&document.documentElement.scrollTop<100||"user"===e.page&&document.documentElement.scrollTop<300||(c.wheelDelta>0?t.style.top="0px":t.style.top="-50px")}return window.addEventListener("mousewheel",c),function(){return window.removeEventListener("mousewheel",c)}}),[e]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("nav",{children:Object(n.jsxs)("div",{className:"nav-slider-outer",children:[Object(n.jsxs)("div",{className:"top-nav",children:[Object(n.jsx)(Q.b,{to:"/",className:"home-logo",children:Object(n.jsx)("img",{src:"/images/icon2.jpg",alt:"zhi \u547c"})}),Object(n.jsxs)("ul",{className:"home-list",children:[Object(n.jsx)("li",{children:Object(n.jsx)(Q.b,{to:"/",children:"\u9996\u9875"})}),Object(n.jsx)("li",{children:Object(n.jsx)(Q.b,{to:"/",children:"\u53d1\u73b0"})}),Object(n.jsx)("li",{children:Object(n.jsx)(Q.b,{to:"/",children:"\u7b49\u4f60\u6765\u7b54"})})]}),Object(n.jsxs)("div",{className:"search-div",children:[Object(n.jsxs)("label",{className:"search-label",children:[Object(n.jsx)("input",{type:"search",name:"search",className:"search",placeholder:"\u529f\u80fd\u5c1a\u672a\u5b8c\u5584"}),Object(n.jsx)(j.a,{style:{fontSize:"20px",color:"#9AA3B5"}})]}),Object(n.jsx)("input",{type:"button",className:"question",value:"\u53d1\u5e16",onClick:P})]}),Object(n.jsxs)("ul",{className:"persen-list",children:[Object(n.jsxs)("li",{children:[Object(n.jsx)(u.a,{style:{fontSize:"22px"},onClick:function(e){return p([U,i],e)}}),0!==y&&Object(n.jsx)("label",{className:"nav-message-icon",onClick:function(e){return p([U,i],e)},children:y})]}),Object(n.jsxs)("li",{children:[Object(n.jsx)(d.a,{style:{fontSize:"20px"},onClick:function(e){return q([i,I],e)}}),0!==L&&Object(n.jsx)("label",{className:"nav-message-icon",onClick:function(e){return q([i,I],e)},children:L})]}),Object(n.jsx)("li",{onClick:function(e){return Y([U,I],e)},children:Object(n.jsx)(b.a,{style:{fontSize:"20px"}})})]})]}),e.children]})}),Object(n.jsxs)("div",{className:"nav-pull-container",children:[Object(n.jsx)(le,{inviteMsg:x,byCareMsg:v,byCommentMsg:g,className:k?"":"nav-message-hidden"}),Object(n.jsx)(be,{className:w?"":"nav-message-hidden",chatList:D}),Object(n.jsx)(oe,{display:a}),!O.sign&&Object(n.jsx)("div",{className:"user-not-sign",children:Object(n.jsx)(W,{})}),T.sucessSignup&&Object(n.jsx)(ie,{props:T})]})]})};var oe=Object(P.h)((function(e){var t=Object(s.useState)(N.getState().cookieUser),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(N.getState().userInfo||{}),o=Object(l.a)(r,2),j=o[0],u=o[1];Object(s.useEffect)((function(){var e=N.subscribe((function(){u(N.getState().userInfo||{}),i(N.getState().cookieUser)}));return function(){return e()}}),[]);var d=Object(s.useCallback)((function(){C.a.post("/api/clearCookie/")}),[]),b=Object(s.useCallback)((function(){void 0===a?N.dispatch({type:"toSign",sign:!1}):(e.history.push("/user/".concat(j.userId)),q.dispatch({type:"editState",edit:!0}))}),[j,a,e.history]),h=Object(s.useCallback)((function(){void 0===a?N.dispatch({type:"toSign",sign:!1}):e.history.push("/user/".concat(j.userId))}),[j,a,e.history]);return Object(n.jsxs)("div",{className:"pull-down",style:{display:e.display},children:[Object(n.jsx)("span",{className:"flag",children:Object(n.jsx)("i",{})}),Object(n.jsxs)("ul",{className:"home-pull",children:[Object(n.jsxs)("li",{onClick:h,children:[Object(n.jsx)(m.a,{}),"\u6211\u7684\u9996\u9875"]}),Object(n.jsxs)("li",{onClick:b,children:[Object(n.jsx)(O.a,{}),"\u7f16\u8f91\u8d44\u6599"]}),Object(n.jsx)("li",{onClick:d,children:Object(n.jsxs)(Q.b,{to:"/sign",children:[Object(n.jsx)(f.a,{}),"\u9000\u51fa\u767b\u9646"]})})]})]})}));function le(e){var t=e.inviteMsg,c=e.byCareMsg,a=e.byCommentMsg,i=e.className,r=Object(s.useState)(0),o=Object(l.a)(r,2),j=o[0],u=o[1],d=[t,c,a][j],b=Object(s.useState)(!1),m=Object(l.a)(b,2),O=m[0],f=m[1];return Object(s.useEffect)((function(){document.querySelector(".nav-invited-list").offsetHeight>=430&&f(!0)}),[j]),Object(n.jsxs)("div",{className:"nav-invited-outer ".concat(i),children:[Object(n.jsx)("span",{className:"flag",children:Object(n.jsx)("i",{})}),Object(n.jsx)("div",{className:"nav-invited-head",children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{onClick:function(){return u(0)},children:Object(n.jsx)(h.a,{className:0===j?"active-msgList":""})}),Object(n.jsx)("li",{onClick:function(){return u(1)},children:Object(n.jsx)(p.a,{className:1===j?"active-msgList":""})}),Object(n.jsx)("li",{onClick:function(){return u(2)},children:Object(n.jsx)(x.a,{className:2===j?"active-msgList":""})})]})}),Object(n.jsxs)("ul",{className:O?"nav-invited-list nav-invited-scroll":"nav-invited-list",children:[1===j&&Object(n.jsx)("div",{className:"msgList-care-head",children:Object(n.jsx)("span",{children:"\u6700\u8fd1\u8fd9\u4e9b\u4eba\u5173\u6ce8\u4e86\u4f60"})}),0!==d.length&&d.map((function(e,t){return Object(n.jsxs)(s.Fragment,{children:[0===j&&Object(n.jsx)(je,{item:e}),1===j&&Object(n.jsx)(ue,{item:e}),2===j&&Object(n.jsx)(de,{item:e})]},t)})),0===d.length&&Object(n.jsx)("li",{className:"nav-invited-item",children:Object(n.jsx)(H.a,{image:H.a.PRESENTED_IMAGE_SIMPLE,description:"\u8fd8\u6ca1\u6709\u65b0\u7684\u52a8\u6001\u54e6\uff01"})})]})]})}function je(e){var t=e.item;return Object(n.jsxs)("li",{className:"nav-invited-item",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.userId),children:t.userName}),Object(n.jsx)("span",{children:"\xa0\u9080\u8bf7\u60a8\u56de\u7b54\u95ee\u9898\xa0"}),Object(n.jsx)(Q.b,{to:"/post-page/".concat(t.postId),children:t.title})]},t.createdAt)}function ue(e){var t=e.item;return Object(n.jsx)("li",{className:"nav-cares-item",children:Object(n.jsxs)(Q.b,{to:"/user/".concat(t.userId),children:[Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(t.avatar,")")},className:"msgList-care-avatar"}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{children:t.name}),Object(n.jsx)("span",{children:t.sign})]})]})},t.createdAt)}function de(e){var t=e.item,c=V()(1*t.createdAt).endOf().fromNow(!0)+"\u524d",s=1*parseInt(c)>1&&/\u5929/g.test(c)?V()(1*t.createdAt).format("MM-DD HH:mm"):c;return Object(n.jsxs)("li",{className:"nav-invited-item",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.userId),children:t.userName}),Object(n.jsxs)("span",{children:["\xa0\u70b9\u8d5e\u4e86\u60a8\u7684\u56de\u7b54:\xa0",Object(n.jsx)("span",{className:"nav-comment-item-time",children:s})]}),Object(n.jsx)(Q.b,{to:"/post-page/".concat(t.postId),className:"nav-comment-item-content",children:t.content}),Object(n.jsx)(Q.b,{to:"/post-page/".concat(t.postId),className:"nav-comment-item-title",title:t.title,children:t.title})]},t.createdAt)}function be(e){var t=e.className,c=e.chatList,a=Object(s.useState)(0),i=Object(l.a)(a,2),r=i[0],j=i[1],u=Object(s.useState)(N.getState().cares||{}),d=Object(l.a)(u,2),b=d[0],m=d[1],O=Object(s.useState)(!1),f=Object(l.a)(O,2),h=f[0],p=f[1],x=Object(s.useState)(N.getState()),v=Object(l.a)(x,2),g=v[0],y=v[1],k=Object(s.useState)({}),I=Object(l.a)(k,2),S=I[0],A=I[1],E=Object(s.useState)(!1),w=Object(l.a)(E,2),L=w[0],D=w[1],q=Object(s.useState)(!1),U=Object(l.a)(q,2),M=U[0],F=U[1];Object(s.useEffect)((function(){var e=N.subscribe((function(){y(N.getState()),m(N.getState().cares)}));return function(){return e()}}),[]);var T=c.filter((function(e){return e[0].userName===g.cookieUser?b[e[0].targetId]:b[e[0].userId]})),P=c.filter((function(e){return e[0].userName===g.cookieUser?!b[e[0].targetId]:!b[e[0].userId]})),Y=Object(s.useCallback)((function(e,t,c){p(!h),A(c),C.a.post("/api/clear-chat",{targetName:e.name}),t(0)}),[h]);return Object(s.useEffect)((function(){h||C.a.get("/api/chat-list").then((function(e){var t=e.data;N.dispatch(Object(o.a)({type:"getInitial"},t))}))}),[h]),Object(s.useEffect)((function(){if(g.cookieUser){var e=0;T.forEach((function(t){var c=t.filter((function(e){return"normal"===e.status&&e.userName!==g.cookieUser}));e+=c.length})),D(!!e);var t=0;P.forEach((function(e){var c=e.filter((function(e){return"normal"===e.status&&e.userName!==g.cookieUser}));t+=c.length})),F(!!t)}}),[T,P,g]),Object(n.jsxs)("div",{className:"nav-invited-outer ".concat(t," nav-chat-outer"),children:[Object(n.jsx)("span",{className:"flag",children:Object(n.jsx)("i",{})}),Object(n.jsx)("div",{className:"nav-invited-head",children:Object(n.jsxs)("ul",{className:"nav-chat-head",children:[Object(n.jsxs)("li",{onClick:function(){return j(0)},className:0===r?"nav-chat-active":"nav-chat",children:[Object(n.jsx)("span",{children:"\u6700\u8fd1\u8054\u7cfb"}),L&&Object(n.jsx)("label",{className:"chat-head-label"})]}),Object(n.jsxs)("li",{onClick:function(){return j(1)},className:1===r?"nav-chat-active":"nav-chat",children:[Object(n.jsx)("span",{children:"\u964c\u751f\u4eba\u79c1\u4fe1"}),M&&Object(n.jsx)("label",{className:"chat-head-label"})]})]})}),Object(n.jsxs)("ul",{className:"nav-chat-list nav-invited-list",children:[0===r&&0!==T.length&&T.map((function(e){var t,c=e.filter((function(e){return"normal"===e.status&&e.userName!==g.cookieUser})).length;return t=e[0].targetName===g.cookieUser?e[0].userId:e[0].targetId,Object(n.jsx)(s.Fragment,{children:Object(n.jsx)(me,{item:e[0],targetId:t,unread:c,onClick:Y})},e[0].createdAt)})),1===r&&0!==P.length&&P.map((function(e){var t,c=e.filter((function(e){return"normal"===e.status&&e.userName!==g.cookieUser})).length;return t=e[0].targetName===g.cookieUser?e[0].userId:e[0].targetId,Object(n.jsx)(s.Fragment,{children:Object(n.jsx)(Oe,{item:e[0],unread:c,targetId:t,onClick:Y})},e[0].createdAt)})),(0===P.length&&1===r||0===T.length&&0===r)&&Object(n.jsx)("li",{className:"nav-invited-item",children:Object(n.jsx)(H.a,{image:H.a.PRESENTED_IMAGE_SIMPLE,description:"\u8fd8\u6ca1\u6709\u79c1\u4fe1\u54e6\uff01"})})]}),h&&Object(n.jsx)(ne,{targetInfo:S,state:g,setChat:p})]})}function me(e){var t=e.item,c=e.unread,a=e.onClick,i=e.targetId,r=t.userId===i?t.userAvatar:t.targetAvatar,o=t.userId===i?t.userName:t.targetName,j=Object(s.useState)(c),u=Object(l.a)(j,2),d=u[0],b=u[1],m=Object(s.useState)({}),O=Object(l.a)(m,2),f=O[0],h=O[1];return Object(s.useEffect)((function(){C.a.post("/api/userInfo-serach",{id:i}).then((function(e){h(e.data.userInfo)}))}),[i]),Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("li",{className:"nav-chat-item",onClick:function(){return a(f,b,f)},children:[0!==d&&Object(n.jsx)("label",{className:"nav-message-icon chat-unred",children:d}),Object(n.jsxs)("div",{children:[Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(r,")")},className:"msgList-care-avatar"}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{children:o}),Object(n.jsx)("span",{children:t.content})]})]})]},t.createdAt)})}function Oe(e){var t=e.item,c=e.unread,a=e.onClick,i=e.targetId,r=t.userId===i?t.userAvatar:t.targetAvatar,o=t.userId===i?t.userName:t.targetName,j=Object(s.useState)(c),u=Object(l.a)(j,2),d=u[0],b=u[1],m=Object(s.useState)({}),O=Object(l.a)(m,2),f=O[0],h=O[1];return Object(s.useEffect)((function(){C.a.post("/api/userInfo-serach",{id:i}).then((function(e){h(e.data.userInfo)}))}),[i]),Object(n.jsxs)("li",{className:"nav-chat-item",onClick:function(){return a(f,b,f)},children:[0!==d&&Object(n.jsx)("label",{className:"nav-message-icon chat-unred",children:d}),Object(n.jsxs)("div",{children:[Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(r,")")},className:"msgList-care-avatar"}),Object(n.jsxs)("div",{children:[Object(n.jsx)("h4",{children:o}),Object(n.jsx)("span",{children:t.content})]})]})]},t.createdAt)}c(222);var fe=c(150),he=c.n(fe);function pe(e){var t=e.setEditValue,c=Object(s.useRef)(),a=Object(s.useRef)(),i=Object(s.useState)({}),r=Object(l.a)(i,2),o=r[0],j=r[1];return o.txt=o.txt||{},Object(s.useEffect)((function(){var e=c.current,n=(a.current,new he.a(e));return j(n),n.config.placeholder="write something...",n.config.onchange=function(e){t({html:e,text:n.txt.text()})},n.config.onchangeTimeout=1e3,n.config.pasteFilterStyle=!0,n.config.uploadFileName="upImage",n.config.uploadImgServer="/api/edit-Image",n.create(),function(){n.destroy()}}),[]),Object(n.jsx)("div",{children:Object(n.jsx)("div",{ref:c})})}var xe=function(){var e=Object(s.useState)({html:"",text:""}),t=Object(l.a)(e,2),c=t[0],a=t[1],i=Object(s.useCallback)((function(){var e={title:document.querySelector("#fileName").value,content:JSON.stringify(c)};""!==e.title.trim()&&""!==e.content.trim()&&C.a.post("/api/home_Page/",e).then((function(e){E.dispatch({type:"postQuestion",question:!1,postCount:e.data.postCount,posts:e.data.posts})})).catch((function(e){401===e.response.status&&(N.dispatch({type:"toSign",sign:!1}),E.dispatch({type:"question",question:!1}))}))}),[c]),r=Object(s.useCallback)((function(){E.dispatch({type:"question",question:!1})}),[]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("label",{className:"clear-qus",onClick:r,children:"x"}),Object(n.jsx)("div",{id:"questionDiv",children:Object(n.jsxs)("div",{className:"question-outer",children:[Object(n.jsx)("div",{className:"header",children:Object(n.jsx)("input",{type:"text",id:"fileName",placeholder:"\u8bf7\u8f93\u5165\u6807\u9898",name:"title"})}),Object(n.jsx)("section",{children:Object(n.jsx)(pe,{setEditValue:a})}),Object(n.jsx)("label",{className:"qst-submit",onClick:i,children:"\u53d1\u5e03\u95ee\u9898"})]})})]})},ve=c(341),ge=c(342),ye=c(343),Ce=c(344),ke=c(345),Ne=c(322),Ie=c(320),Se=c(339),Ae=c(340),Ee=Z.a.TextArea;function we(e){var t=e.item,c=e.commentId,a=e.state,i=e.ansCommentId,r=a.myLikeEndComment,o=void 0===r?{}:r,j=a.myPoorEndComment,u=void 0===j?{}:j,b=Object(s.useState)(""),m=Object(l.a)(b,2),O=m[0],f=m[1],h=Object(s.useState)(!1),p=Object(l.a)(h,2),v=p[0],g=p[1],y=t.endCommentId,k=Object(s.useCallback)((function(e){f(e.target.value)}),[]),I=Object(s.useCallback)((function(){g(!v)}),[v]),S=Object(s.useCallback)((function(e){"\u8d5e"===e?T.dispatch({type:"likeEndComment",id:y,ansCommentId:t.ansCommentId}):T.dispatch({type:"poorEndComment",id:y,ansCommentId:t.ansCommentId})}),[y,t]),A=Object(s.useCallback)((function(){void 0!==a.cookieUser?""!==O.trim()&&(C.a.post("/api/endComment/".concat(i),{content:O,targetUserId:t.userId,commentId:c}).then((function(e){T.dispatch({type:"postEndComment",id:i,newList:e.data.newEndCommentList})})),f("")):N.dispatch({type:"toSign",sign:!1})}),[i,O,t,c,a]),E=Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("ul",{className:"ansComment-action",children:[Object(n.jsxs)("li",{onClick:function(){return S("\u8d5e")},className:o[y]?"activeAnsComment":"",children:[Object(n.jsx)(x.a,{})," ",t.like]}),Object(n.jsxs)("li",{onClick:function(){return S("\u8e29")},className:u[y]?"activeAnsComment":"",children:[Object(n.jsx)(Se.a,{})," \u8e29"]}),Object(n.jsxs)("li",{onClick:I,children:[Object(n.jsx)(d.a,{})," ",v?"\u53d6\u6d88\u56de\u590d":"\u56de\u590d"]})]}),v&&Object(n.jsxs)(Ne.a.Item,{children:[Object(n.jsx)(Ee,{autoSize:!0,placeholder:" \u56de\u590d "+t.name,className:"endComment",style:{width:"490px",marginRight:"15px"},onInput:k,value:O}),Object(n.jsx)(ee.a,{htmlType:"submit",type:"primary",onClick:A,children:"\u53d1\u9001"})]})]}),w=Object(n.jsxs)("div",{className:"ansComment-header",children:[Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(t.avatar,")")},className:"endComment-avatar"}),Object(n.jsxs)(Q.b,{to:"/user/".concat(t.userId),children:[t.name,t.userId===c?"(\u4f5c\u8005)":""]}),"\xa0\xa0\u56de\u590d\xa0\xa0",Object(n.jsxs)(Q.b,{to:"/user/".concat(t.targetUserId),children:[t.targetName,t.targetUserId===c?"(\u4f5c\u8005)":""]})]}),L=V()(1*t.createdAt).endOf().fromNow(!0)+"\u524d";return Object(n.jsx)(Ie.a,{actions:[E],author:[w],datetime:1*parseInt(L)>1&&/\u5929/g.test(L)?V()(1*t.createdAt).format("MM-DD HH:mm:ss"):L,content:Object(n.jsx)("p",{children:t.content})})}var Le=Z.a.TextArea,De=function(e){var t=e.id,c=Object(s.useState)({ansCommentList:[]}),a=Object(l.a)(c,2),i=a[0],r=a[1];Object(s.useEffect)((function(){C.a.get("/api/ansComment/".concat(t)).then((function(e){var c=e.data;T.dispatch({type:"getInitial",id:t,ansCommentList:c.ansCommentList,myLikeAnsComment:c.myLikeAnsComment,myPoorAnsComment:c.myPoorAnsComment,cookieUser:c.cookieUser})}))}),[t]);var o=i.ansCommentList[t]||[];return Object(s.useEffect)((function(){var e=T.subscribe((function(){return r(T.getState())}));return function(){return e()}}),[]),Object(n.jsxs)("div",{className:"ansComment-outer",children:[Object(n.jsx)("div",{className:"ansComment-head",children:Object(n.jsxs)("h4",{children:[o.length," \u6761\u8bc4\u8bba"]})}),Object(n.jsx)("ul",{className:"ansComment-container",children:o.map((function(e,t){return Object(n.jsx)(s.Fragment,{children:Object(n.jsx)(qe,{item:e,state:i})},t)}))}),Object(n.jsx)("div",{className:"ansComment-put",children:Object(n.jsx)(Ue,{state:i,id:t})})]})};function qe(e){var t=e.item,c=t.ansCommentId,a=e.state,i=a.myLikeAnsComment,r=void 0===i?{}:i,o=a.myPoorAnsComment,j=void 0===o?{}:o,u=Object(s.useState)(!1),b=Object(l.a)(u,2),m=b[0],O=b[1],f=Object(s.useState)(""),h=Object(l.a)(f,2),p=h[0],v=h[1],g=Object(s.useState)(!1),y=Object(l.a)(g,2),k=y[0],I=y[1],S=Object(s.useState)(!0),A=Object(l.a)(S,2),E=A[0],w=A[1],L=Object(s.useState)(e.state.endCommentList[c]||[]),D=Object(l.a)(L,2),q=D[0],U=D[1],M=Object(s.useState)(!1),F=Object(l.a)(M,2),H=F[0],P=F[1];Object(s.useEffect)((function(){t.endComment>0?P(!0):P(!1)}),[t]),Object(s.useEffect)((function(){var e=T.subscribe((function(){var t=T.getState().endCommentList[c];return U(t),function(){return e()}}))}),[c]);var Y=Object(s.useCallback)((function(e){v(e.target.value)}),[]);Object(s.useEffect)((function(){C.a.get("/api/endComment/".concat(c)).then((function(e){var t=e.data;T.dispatch({type:"getEndCommentList",id:c,endCommentList:t.endCommentList,myLikeEndComment:t.myLikeEndComment,myPoorEndComment:t.myPoorEndComment,cookieUser:t.cookieUser})}))}),[c]);var z=Object(s.useCallback)((function(e){"\u8d5e"===e?T.dispatch({type:"likeAnsComment",id:c,commentId:t.commentId}):T.dispatch({type:"poorAnsComment",id:c,commentId:t.commentId})}),[c,t]),R=Object(s.useCallback)((function(){O(!m)}),[m]),_=Object(s.useCallback)((function(){void 0!==e.state.cookieUser?""!==p.trim()&&(C.a.post("/api/endComment/".concat(c),{content:p,targetUserId:t.userId,commentId:t.commentId}).then((function(e){T.dispatch({type:"postEndComment",id:c,newList:e.data.newEndCommentList,commentId:t.commentId}),w(!1),I(!0)})),v("")):N.dispatch({type:"toSign",sign:!1})}),[c,p,e,t]),B=Object(s.useCallback)((function(){w(!E),!0===E&&I(!1)}),[E]),J=Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("ul",{className:"ansComment-action",children:[Object(n.jsxs)("li",{onClick:function(){return z("\u8d5e")},className:r[c]?"activeAnsComment":"",children:[Object(n.jsx)(x.a,{})," ",t.like]}),Object(n.jsxs)("li",{onClick:function(){return z("\u8e29")},className:j[c]?"activeAnsComment":"",children:[Object(n.jsx)(Se.a,{})," \u8e29"]}),H&&Object(n.jsxs)("li",{onClick:B,children:[Object(n.jsx)(Ae.a,{}),E?" \u67e5\u770b\u56de\u590d":" \u9690\u85cf\u56de\u590d"," "]}),Object(n.jsxs)("li",{onClick:R,children:[Object(n.jsx)(d.a,{})," ",m?"\u53d6\u6d88\u56de\u590d":"\u56de\u590d"]})]}),m&&Object(n.jsxs)(Ne.a.Item,{children:[Object(n.jsx)(Le,{autoSize:!0,placeholder:" \u56de\u590d "+t.name,className:"endComment",style:{width:"535px",marginRight:"15px"},onInput:Y,value:p}),Object(n.jsx)(ee.a,{htmlType:"submit",type:"primary",onClick:_,children:"\u53d1\u9001"})]})]}),W=Object(n.jsxs)("div",{className:"ansComment-header",children:[Object(n.jsx)("i",{className:"endComment-avatar",style:{backgroundImage:"url(".concat(t.avatar,")")}}),Object(n.jsxs)(Q.b,{to:"/user/".concat(t.userId),children:[t.name,t.userId===t.commentId?"(\u4f5c\u8005)":""]})]}),G=V()(1*t.createdAt).endOf().fromNow(!0)+"\u524d";return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(Ie.a,{actions:[J],author:[W],datetime:1*parseInt(G)>1&&/\u5929/g.test(G)?V()(1*t.createdAt).format("MM-DD HH:mm:ss"):G,content:Object(n.jsx)("p",{children:t.content}),children:!E&&Object(n.jsxs)(n.Fragment,{children:[!k&&q.slice(0,2).map((function(s){return Object(n.jsx)(we,{item:s,commentId:t.commentId,state:e.state,ansCommentId:c})})),q.length>2&&Object(n.jsxs)("span",{className:"all-endComment",onClick:function(){return I(!0)},style:{display:k?"none":"block"},children:["\u67e5\u770b\u5168\u90e8",q.length,"\u6761\u56de\u590d"]}),k&&q.map((function(s){return Object(n.jsx)(we,{item:s,commentId:t.commentId,state:e.state,ansCommentId:c})}))]})})})}function Ue(e){var t=e.id,c=Object(s.useState)(""),a=Object(l.a)(c,2),i=a[0],r=a[1],o=Object(s.useCallback)((function(e){r(e.target.value)}),[]),j=Object(s.useCallback)((function(){void 0!==e.state.cookieUser?""!==i.trim()&&C.a.post("/api/ansComment/".concat(t),{content:i}).then((function(e){T.dispatch({type:"postComment",id:t,newList:e.data.newAnsCommentList}),L.dispatch({type:"ansCommentList",id:t}),r("")})):N.dispatch({type:"toSign",sign:!1})}),[t,i,e]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(Ne.a.Item,{children:Object(n.jsx)(Le,{rows:2,placeholder:"\u8bf7\u8f93\u5165\u8bc4\u8bba\u5185\u5bb9",onInput:o,value:i})}),Object(n.jsx)(Ne.a.Item,{children:Object(n.jsx)(ee.a,{htmlType:"submit",type:"primary",onClick:j,children:"\u6dfb\u52a0\u8bc4\u8bba"})})]})}function Me(e){var t=e.footer,c=e.idx,a="question"===e.type,i=function(e){var t="question"===e.type,c=Object(s.useState)(e.post||e.comment),n=Object(l.a)(c,2),a=n[0],i=n[1],r=t?a.postId:a.commentId,o=Object(s.useState)(),j=Object(l.a)(o,2),u=j[0],d=j[1],b=Object(s.useState)(),m=Object(l.a)(b,2),O=m[0],f=m[1],h=Object(s.useState)(),p=Object(l.a)(h,2),x=p[0],v=p[1],g=Object(s.useState)(),y=Object(l.a)(g,2),C=y[0],k=y[1];Object(s.useEffect)((function(){if(t){d(e.state.attention[r]),f(e.state.poors[r]),v(e.state.collect_quesActive[r]),k(e.state.favoriteQues[r]);var c=E.subscribe((function(){var e=E.getState().posts.find((function(e){return e.postId===r}));i(e)}));return function(){return c()}}d(e.state.likes[r]),f(e.state.commentPoors[r]),v(e.state.collect_commActive[r]),k(e.state.favoriteComment[r]);var n=L.subscribe((function(){var e=L.getState().commenterInfo.find((function(e){return e.commentId===r}));i(e||{})}));return function(){return n()}}),[r,t,e]);var I=Object(s.useCallback)((function(){void 0===e.state.cookieUser?N.dispatch({type:"toSign",sign:!1}):E.dispatch({type:"toAttention",postId:r,like:a.qusLike})}),[a,r,e]),S=Object(s.useCallback)((function(){void 0===e.state.cookieUser?N.dispatch({type:"toSign",sign:!1}):t?E.dispatch({type:"poorButton",postId:r,poor:a.poor}):L.dispatch({type:"poorButton",commentId:r,poor:a.poor})}),[r,a,t,e]),A=Object(s.useCallback)((function(){void 0===e.state.cookieUser?N.dispatch({type:"toSign",sign:!1}):L.dispatch({type:"likeComment",commentId:r,like:a.like})}),[a,r,e]),w=Object(s.useCallback)((function(){void 0===e.state.cookieUser?N.dispatch({type:"toSign",sign:!1}):t?E.dispatch({type:"collect",collectId:r,id:a.posterId}):L.dispatch({type:"collect",collectId:r,id:a.commenterId})}),[t,a,e,r]),D=Object(s.useCallback)((function(){void 0===e.state.cookieUser?N.dispatch({type:"toSign",sign:!1}):t?E.dispatch({type:"favorite",favoriteId:r,id:a.posterId}):L.dispatch({type:"favorite",favoriteId:r,id:a.commenterId})}),[t,a,e,r]);return{post:a,active:u,poorActive:O,toAttention:I,poorButton:S,likeComment:A,getCollect:w,collectActive:x,getFavorite:D,favoriteActive:C}}(e),r=i.post,o=void 0===r?{}:r,j=i.active,u=i.poorActive,b=i.toAttention,m=i.likeComment,O=i.poorButton,f=i.getCollect,h=i.collectActive,x=i.getFavorite,v=i.favoriteActive,g=Object(s.useState)(!0),y=Object(l.a)(g,2),C=y[0],k=y[1],I=Object(s.useState)(!1),S=Object(l.a)(I,2),A=S[0],w=S[1];Object(s.useEffect)((function(){var e=document.querySelectorAll('[name="content"]> p >span');if(e[c]&&e[c].getBoundingClientRect().height>50){var t=document.querySelectorAll('[name="content"] >p')[c];t.classList.add("flodContent"),t.style.height=a?"3.2em":"2.68em",w(!0)}}),[c,a,t]);var D=Object(s.useCallback)((function(){var e=document.querySelectorAll('[name="content"] >p')[c],t=Array.from(e.classList),n=document.querySelectorAll('[name="content"] >p >span');t.includes("post-defaultHeight")&&e.classList.remove("post-defaultHeight"),t.includes("flodContent")?(e.classList.remove("flodContent"),e.style.height=n[c].getBoundingClientRect().height+5+"px",k(!1)):(e.classList.add("flodContent"),e.style.height=a?"3.2em":"2.68em",k(!0))}),[c]),q=Object(s.useState)(!1),U=Object(l.a)(q,2),M=U[0],F=U[1],T=Object(s.useCallback)((function(){F(!M)}),[M]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"postsfooter",children:[Object(n.jsxs)("button",{type:"button",className:j?"likeActive":"",onClick:a?b:m,children:[Object(n.jsx)(ve.a,{})," ",a?"\u5173\u6ce8 ".concat(o.qusLike):"\u8d5e\u540c ".concat(o.like)," "]}),Object(n.jsxs)("button",{type:"button",className:u?"likeActive":"",onClick:O,children:[Object(n.jsx)(ge.a,{}),a?" \u8e29 ".concat(o.poor):" \u53cd\u5bf9 ".concat(o.poor)]}),Object(n.jsxs)("ul",{children:[Object(n.jsxs)("li",{onClick:T,children:[Object(n.jsx)(d.a,{})," ",a?"".concat(e.post.answerCount," \u6761\u56de\u7b54"):M?"\u6536\u8d77\u8bc4\u8bba":"".concat(e.comment.ansComments," \u6761\u8bc4\u8bba")]}),Object(n.jsxs)("li",{onClick:f,children:[Object(n.jsx)(ye.a,{}),h?"\u5df2\u6536\u85cf":" \u6536\u85cf"," "]}),Object(n.jsxs)("li",{onClick:x,children:[Object(n.jsx)(p.a,{}),v?" \u5df2\u559c\u6b22":" \u559c\u6b22"," "]})]}),A&&Object(n.jsx)(n.Fragment,{children:C?Object(n.jsxs)("span",{onClick:D,children:["\u5168\u90e8\u5c55\u5f00 ",Object(n.jsx)(Ce.a,{})]}):Object(n.jsxs)("span",{onClick:D,children:["\u6536\u8d77 ",Object(n.jsx)(ke.a,{})]})})]}),M&&!a&&Object(n.jsx)(De,{id:o.commentId})]})}var Fe=c(323),Te=function(){return Object(n.jsxs)("div",{className:"invitation",children:[Object(n.jsx)(Ze,{}),Object(n.jsx)(Pe,{}),Object(n.jsx)(Ye,{})]})};function He(e){var t=Object(P.g)().id,c=e.state.cookieUser===e.post.name,a="post"===e.type?e.post.postId:e.post.commentId,i=Object(s.useState)(!1),r=Object(l.a)(i,2),o=r[0],j=r[1];Object(s.useEffect)((function(){var e=function(){j(!1)};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[o]);var u=Object(s.useCallback)((function(){"post"===e.type?C.a.post("/api/deletePost/",{postId:a,type:"post"}).then((function(e){E.dispatch({type:"deletePost",postCount:e.data.postNormal.length,posts:e.data.posts})})):C.a.post("/api/deletePost/",{id:t,postId:a,type:"comment"}).then((function(e){L.dispatch({type:"deleteComment",comments:e.data.comments})}))}),[a,e,t]),d=Object(s.useCallback)((function(e){e.stopPropagation(),j(!o)}),[o]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("span",{className:"deletePost",onClick:d,children:"..."}),o&&Object(n.jsx)("i",{className:"deletePost-flag"}),Object(n.jsx)("div",{className:o?"deAttachment deAttaHeight":"deAttachment",children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{onClick:c?u:function(){},children:Object(n.jsx)("span",{className:c?"":"disableDelete",children:"\u5220\u9664"})}),Object(n.jsx)("li",{children:Object(n.jsx)("span",{children:"\u4e3e\u62a5"})})]})})]})}function Pe(){var e=Object(s.useState)(E.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1],i=Object(s.useState)(new Array(6).fill("")),r=Object(l.a)(i,2),j=r[0],u=r[1],d=Object(s.useState)(!0),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useState)(!1),h=Object(l.a)(f,2),p=h[0],x=h[1];Object(s.useEffect)((function(){C.a.get("/api/home-data").then((function(e){var t=e.data;E.dispatch(Object(o.a)(Object(o.a)({},t),{},{type:"getData",posts:t.posts.filter((function(e){return"delete"!==e.status}))})),O(!1)}));var e=E.subscribe((function(){a(E.getState()),u(E.getState().posts||[])}));return function(){return e()}}),[]),Object(s.useEffect)((function(){var e=document.querySelectorAll(".content-div >p >span");e.forEach((function(e,t){var c=j[t].content;e.innerHTML="{"===c[0]?JSON.parse(c).html:c})),e.length&&x(!0)}),[m]);var v=-1;return Object(n.jsx)("ul",{className:"posts",children:j.map((function(e){var t=1*e.createdAt,s=V()(t).endOf().fromNow(!0)+"\u524d";return"delete"!==e.status?(++v,Object(n.jsx)("li",{children:Object(n.jsxs)(Fe.a,{active:!0,round:!0,loading:m,children:[Object(n.jsxs)("div",{className:"user-date",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(e.posterId),children:Object(n.jsx)("img",{alt:"",style:{backgroundImage:"url(".concat(e.avatar,")")},className:"userAvatar"})}),Object(n.jsxs)("span",{className:"post-username",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(e.posterId),children:e.name}),"  ,",Object(n.jsxs)("span",{className:"post-time",children:["  \u53d1\u5e03\u4e8e",1*parseInt(s)>1&&/\u5929/g.test(s)?V()(t).format("YYYY-MM-DD HH:mm:ss"):s]})]}),Object(n.jsx)(He,{state:c,post:e,type:"post"})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(e.postId),children:e.title}),Object(n.jsx)("p",{className:"post-content flodContent post-defaultHeight",children:Object(n.jsx)("span",{})})]}),Object(n.jsx)(Me,{post:e,idx:v,type:"question",state:c,footer:p})]})},e.postId)):null}))})}function Ye(){return Object(n.jsx)("div",{className:"over",children:Object(n.jsx)("span",{children:"\u6ca1\u6709\u66f4\u591a\u5185\u5bb9\u4e86..."})})}var ze=c(346),Re=c(347),_e=c(348),Qe=function(){var e=Object(s.useState)(E.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(s.useEffect)((function(){var e=E.subscribe((function(){return a(E.getState())}));return function(){return e()}}),[]),Object(n.jsxs)("div",{className:"toolbar",children:[Object(n.jsxs)("div",{className:"toolbar-user-data",children:[Object(n.jsx)(Be,{data:c}),Object(n.jsx)(Je,{cookieUser:c.cookieUser,user:c.user}),Object(n.jsx)(We,{data:c})]}),Object(n.jsx)(Ge,{data:c}),Object(n.jsx)(Ve,{})]})};function Be(e){var t=e.data.cookieUser,c=e.data.user||{},a=Object(s.useCallback)((function(){C.a.post("/api/clearCookie/")}),[]);return Object(n.jsx)("span",{children:void 0!==t?Object(n.jsxs)(n.Fragment,{children:["\u6b22\u8fce\u7528\u6237 ",Object(n.jsx)(Q.b,{to:"/user/"+c.userId,className:"denglu-user",children:t}),Object(n.jsx)(Q.b,{to:"/sign",className:"dengchu",onClick:a,children:"\u767b\u51fa"})]}):Object(n.jsxs)(n.Fragment,{children:["\u5f53\u524d\u5904\u4e8e\u672a\u767b\u5f55\u72b6\u6001",Object(n.jsx)(Q.b,{to:"/sign",className:"dengchu",children:"\u767b\u5f55/\u6ce8\u518c"})]})})}var Je=Object(P.h)((function(e){var t=e.user||{},c=Object(s.useState)(t.avatar),a=Object(l.a)(c,2),i=a[0],r=a[1],o=Object(s.useState)(!1),j=Object(l.a)(o,2),u=j[0],d=j[1],b=Object(s.useCallback)((function(e){var t=new FormData;t.append("avatar",e.target.files[0]),C.a.post("/api/user-avatar/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){r(e.data)}))}),[]),m=Object(s.useCallback)((function(){document.querySelector('[name="avatar"]').click()}),[]);Object(s.useEffect)((function(){r(t.avatar)}),[t]);var O=Object(s.useCallback)((function(c){void 0===e.cookieUser?N.dispatch({type:"toSign",sign:!1}):(e.history.push("/user/".concat(t.userId)),q.dispatch({type:"activeSwitch",active:c}))}),[t,e]);return Object(s.useEffect)((function(){function e(){E.dispatch({type:"hoverAvatar",hover:!0})}function t(){E.dispatch({type:"hoverAvatar",hover:!1})}var c=document.querySelector(".user-avatar");c.addEventListener("mouseenter",e),c.addEventListener("mouseleave",t);var n=E.subscribe((function(){return d(E.getState().hover)}));return function(){n(),c.removeEventListener("mouseenter",e),c.removeEventListener("mouseleave",t)}}),[]),Object(n.jsxs)("div",{className:"user-info",children:[e.cookieUser?Object(n.jsxs)("div",{className:"user-avatar",onClick:m,style:{backgroundImage:"url(".concat(i,")")},children:[Object(n.jsx)("input",{type:"file",name:"avatar",style:{display:"none"},onChange:b}),u&&Object(n.jsxs)("div",{className:"avatarMouseEnter",children:[Object(n.jsx)(ze.a,{}),Object(n.jsx)("span",{children:"\u66f4\u6362\u5934\u50cf"})]})]}):Object(n.jsx)("div",{className:"user-avatar",style:{backgroundImage:"url('/images/default.jpg')"}}),Object(n.jsxs)("ul",{className:"user-bar",children:[Object(n.jsx)("li",{onClick:function(){return O(0)},children:Object(n.jsxs)("span",{children:[Object(n.jsx)(h.a,{}),"\u5168\u90e8\u52a8\u6001"]})}),Object(n.jsx)("li",{onClick:function(){return O(5)},children:Object(n.jsxs)("span",{children:[Object(n.jsx)(ye.a,{}),"\u6211\u7684\u6536\u85cf"]})}),Object(n.jsx)("li",{onClick:function(){return O(4)},children:Object(n.jsxs)("span",{children:[Object(n.jsx)(p.a,{}),"\u6211\u7684\u5173\u6ce8"]})}),Object(n.jsx)("li",{onClick:function(){return O(1)},children:Object(n.jsxs)("span",{children:[Object(n.jsx)(Re.a,{}),"\u5386\u53f2\u56de\u7b54"]})})]})]})}));function We(e){var t=e.data||{},c=t.user||{},a=Object(s.useCallback)((function(e){if(e.stopPropagation(),void 0!==t.cookieUser){var c=document.querySelector(".user-sign-text");c.setAttribute("contenteditable",!0),c.focus(),c.onblur=function(){C.a.post("/api/sign-edit/",{user_sign:c.textContent}),c.setAttribute("contenteditable",!1)}}else N.dispatch({type:"toSign",sign:!1})}),[t]),i=Object(s.useRef)(""),r=Object(s.useCallback)((function(e){var t=e.target.textContent;30===t.length&&(i.current=t),t.length>30&&(e.target.innerText=i.current)}),[]);return Object(n.jsxs)("div",{className:"user-sign",children:[Object(n.jsxs)("i",{className:"el-icon-edit",onClick:a,children:[Object(n.jsx)(_e.a,{style:{fontSize:"16px",marginRight:"8px"}})," "]}),t.cookieUser?Object(n.jsx)("span",{className:"user-sign-text",onInput:r,children:c?c.sign:t.poster.sign}):Object(n.jsx)("span",{children:"\u5f53\u524d\u8fd8\u672a\u767b\u5f55\uff0c\u8d76\u5feb\u524d\u5f80\u767b\u5f55\u5427\uff01"})]})}function Ge(){var e=Object(s.useState)(E.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1],i=Object(s.useState)(!0),r=Object(l.a)(i,2),j=r[0],u=r[1];Object(s.useEffect)((function(){C.a.get("/api/home-data").then((function(e){var t=e.data;E.dispatch(Object(o.a)({type:"getData"},t)),u(!1)}));var e=E.subscribe((function(){return a(E.getState())}));return function(){return e()}}),[]);var d=(c.recommend||new Array(15).fill("")).filter((function(e){return"delete"!==e.status}));return Object(n.jsxs)("div",{className:"recommend",children:[Object(n.jsx)("h3",{children:"\u70ed\u95e8\u95ee\u9898"}),Object(n.jsx)("ul",{className:"recommend-list",children:d.slice(0,15).map((function(e){return Object(n.jsx)("li",{children:Object(n.jsx)(Fe.a,{active:!0,round:!0,paragraph:!1,loading:j,children:Object(n.jsx)(Q.b,{to:"/post-page/"+e.postId,title:e.title,children:e.title})})},e.postId)}))})]})}function Ve(){return Object(n.jsx)("div",{className:"footer-bar",children:Object(n.jsxs)("p",{children:[" \u9648\u542c\u6c34 \u7136\u4e5f\u6307\u5357 \u7136\u4e5f\u534f\u8bae \u7136\u4e5f\u9690\u79c1\u4fdd\u62a4\u6307\u5f15 ",Object(n.jsx)("br",{}),"\u5e94\u7528\u5de5\u4f5c\u7533\u8bf7\u5f00\u901a\u7136\u4e5f\u673a\u6784\u53f7",Object(n.jsx)("br",{}),"\u4fb5\u6743\u4e3e\u62a5\u7f51\u4e0a\u6709\u5bb3\u4fe1\u606f\u4e3e\u62a5\u4e13\u533a",Object(n.jsx)("br",{}),"\u4eac ICP \u8bc1 110745 \u53f7",Object(n.jsx)("br",{}),"\u4eac ICP \u5907 13052560 \u53f7 - 1",Object(n.jsx)("br",{}),"\u4eac\u516c\u7f51\u5b89\u5907 11010802010035 \u53f7",Object(n.jsx)("br",{}),"\u4e92\u8054\u7f51\u836f\u54c1\u4fe1\u606f\u670d\u52a1\u8d44\u683c\u8bc1\u4e66",Object(n.jsx)("br",{}),"\uff08\u4eac\uff09- \u975e\u7ecf\u8425\u6027 - 2017 - 0067\u8fdd\u6cd5\u548c\u4e0d\u826f\u4fe1\u606f\u4e3e\u62a5\uff1a010-82716601",Object(n.jsx)("br",{})," \u513f\u7ae5\u8272\u60c5\u4fe1\u606f\u4e3e\u62a5\u4e13\u533a",Object(n.jsx)("br",{}),"\u8bc1\u7167\u4e2d\u5fc3",Object(n.jsx)("br",{}),"\u8054\u7cfb\u6211\u4eec \xa9 2020 \u7136\u4e5f"]})})}var Ke=function(){return Object(n.jsxs)("div",{className:"body-container",children:[Object(n.jsx)(Te,{}),Object(n.jsx)(Qe,{})]})},$e=function(){var e=Object(s.useState)(E.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(s.useEffect)((function(){C.a.get("/api/home-data").then((function(e){var t=e.data;E.dispatch(Object(o.a)(Object(o.a)({type:"getData"},t),{},{posts:t.posts.filter((function(e){return"delete"!==e.status}))}))}));var e=E.subscribe((function(){return a(E.getState())}));return function(){return e()}}),[]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(re,{children:Object(n.jsx)(Xe,{state:c})}),c.question&&Object(n.jsx)(xe,{}),Object(n.jsx)(Ke,{})]})};function Xe(e){var t=e.state,c=Object(s.useCallback)((function(){void 0!==t.cookieUser?E.dispatch({type:"question",question:!0}):N.dispatch({type:"toSign",sign:!1})}),[t]);return Object(n.jsxs)("div",{className:"top-nav home-slider-nav",children:[Object(n.jsx)(Q.b,{to:"/",className:"home-logo",children:Object(n.jsx)("img",{src:"/images/icon2.jpg",alt:"zhi \u547c"})}),Object(n.jsx)(Ze,{}),Object(n.jsxs)("div",{className:"search-div",children:[Object(n.jsxs)("label",{className:"search-label",children:[Object(n.jsx)("input",{type:"search",name:"search",className:"search",placeholder:"\u529f\u80fd\u5c1a\u672a\u5b8c\u5584"}),Object(n.jsx)(j.a,{style:{fontSize:"20px",color:"#9AA3B5"}})]}),Object(n.jsx)("input",{type:"button",className:"question",value:"\u53d1\u5e16",onClick:c})]})]})}function Ze(){return Object(n.jsxs)("ul",{className:"home-list",children:[Object(n.jsx)("li",{children:Object(n.jsx)(Q.b,{to:"/",children:"\u63a8\u8350"})}),Object(n.jsx)("li",{children:Object(n.jsx)(Q.b,{to:"/",children:"\u5173\u6ce8"})}),Object(n.jsx)("li",{children:Object(n.jsx)(Q.b,{to:"/",children:"\u70ed\u699c"})})]})}function et(){var e=Object(s.useState)(S.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(s.useEffect)((function(){var e=S.subscribe((function(){return a(S.getState())}));return function(){return e()}})),Object(n.jsxs)("div",{className:"main",children:[Object(n.jsx)("img",{src:"../images/login-top2.png",alt:"logo",className:"logo"}),c.sucessSignup&&Object(n.jsx)(tt,{props:c}),Object(n.jsx)(W,{state:c}),Object(n.jsx)(se,{})]})}function tt(e){return Object(n.jsx)("div",{className:"success-bg",children:Object(n.jsxs)("div",{className:"suc-transition success",children:[Object(n.jsx)("img",{src:"./images/loading.gif",alt:"\u6ce8\u518c\u6210\u529f"}),Object(n.jsxs)("label",{className:"label-visi",children:[Object(n.jsx)("span",{children:"\u6ce8\u518c\u6210\u529f\uff01 "})," \u70b9\u51fb ",Object(n.jsx)(Q.b,{to:"/sign",children:"\u8fd4\u56de\u767b\u9646\u754c\u9762"})]})]})})}c(297);var ct=function(){return Object(n.jsx)("div",{className:"login-container",children:Object(n.jsx)(et,{})})},nt=c(28),st=c.n(nt),at=c(54),it=(c(298),function(e){var t=Object(s.useState)(L.getState()),c=Object(l.a)(t,2),a=c[0],i=c[1];return Object(s.useEffect)((function(){var e=L.subscribe((function(){return i(L.getState())}));return function(){return e()}})),Object(n.jsxs)("div",{className:"body-container post-container",children:[Object(n.jsx)(rt,{data:a,loading:e.loading}),Object(n.jsx)(ut,{data:a})]})});function rt(e){var t=e.data.commenterInfo||[];return Object(n.jsxs)("div",{className:"invitation",children:[e.data.writeAnswer?Object(n.jsx)(ot,{}):"",Object(n.jsx)("div",{className:"comment-main",children:Object(n.jsx)("ul",{className:"comments-list",children:Object(n.jsx)(lt,{commenterInfo:t,loading:e.loading})})}),Object(n.jsx)(Ye,{})]})}function ot(){var e=Object(P.g)().id,t=Object(s.useState)({html:"",text:""}),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useCallback)((function(){var t={content:JSON.stringify(a),createdAt:Date.now()};function c(){return(c=Object(at.a)(st.a.mark((function c(){return st.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,C.a.post("/api/post-page/".concat(e),t).then((function(e){L.dispatch({type:"postAnswer",commenterInfo:e.data})})).catch((function(e){401===e.response.status&&N.dispatch({type:"toSign",sign:!1})}));case 2:case"end":return c.stop()}}),c)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[e,a]);return Object(n.jsxs)("div",{className:"answer-outer editing",children:[Object(n.jsx)(pe,{setEditValue:i}),Object(n.jsx)("div",{className:"submit-answer",children:Object(n.jsx)("span",{onClick:r,children:"\u63d0\u4ea4\u56de\u7b54"})})]})}function lt(e){var t=Object(s.useState)(L.getState()),c=Object(l.a)(t,2),a=c[0],i=c[1];Object(s.useEffect)((function(){var e=L.subscribe((function(){return i(L.getState())}));return function(){return e()}}),[]);var r=(a.commenterInfo||new Array(5).fill("")).filter((function(e){return"delete"!==e.status})),o=-1;return e.loading||0!==r.length?r.map((function(t){return o++,Object(n.jsx)(Fe.a,{loading:e.loading,children:Object(n.jsx)(jt,{item:t,data:a,idx:o},t.createdAt)})})):Object(n.jsx)("li",{style:{color:"#8590A6"},children:"\u5f53\u524d\u5e16\u5b50\u8fd8\u6ca1\u6709\u56de\u7b54\uff0c\u8d76\u7d27\u53bb\u6dfb\u52a0\u56de\u7b54\u5427\uff01"})}function jt(e){var t=e.item,c=e.data,a=e.idx,i=1*t.createdAt,r=V()(i).endOf().fromNow(!0)+"\u524d",o=Object(s.useState)(!1),j=Object(l.a)(o,2),u=j[0],d=j[1];return Object(s.useEffect)((function(){var e=document.querySelectorAll(".flodContent >span")[a];e&&(e.innerHTML="{"!==t.content[0]?t.content:JSON.parse(t.content).html,d(!0))}),[t,a]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"commenter-info",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.userId),children:Object(n.jsx)("i",{className:"commenter-avatar",style:{backgroundImage:"url(".concat(t.avatar,")")}})}),Object(n.jsxs)("div",{className:"commenter-flag",children:[Object(n.jsx)(Q.b,{className:"commenter-name",to:"/user/".concat(t.userId),children:t.name}),Object(n.jsx)("span",{className:"commenter-sign",children:t.sign}),Object(n.jsx)(He,{state:c,post:t,type:"comment"})]})]}),Object(n.jsxs)("div",{className:"content-div ",name:"content",children:[Object(n.jsx)("p",{className:"flodContent",children:Object(n.jsx)("span",{})}),Object(n.jsxs)("span",{className:"answerAt",children:["\u53d1\u5e03\u4e8e \xa0",1*parseInt(r)>1&&/\u5929/g.test(r)?V()(1*t.createdAt).format("YYYY-MM-DD HH:mm:ss"):r]}),Object(n.jsx)("div",{className:"commenter-footer",children:Object(n.jsx)(Me,{comment:t,idx:a,state:c,footer:u})})]})]},t.createdAt)}function ut(e){var t=e.data||{},c=t.poster||{};return Object(n.jsxs)("div",{className:"toolbar",children:[Object(n.jsxs)("div",{className:"toolbar-user-data",children:[Object(n.jsx)("h4",{style:{color:"rgb(118,131,155)"},children:"\u5173\u4e8e\u63d0\u95ee\u8005"}),c.name===t.cookieUser?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(Je,{cookieUser:t.cookieUser,user:t.poster}),Object(n.jsx)(We,{data:t})]}):Object(n.jsx)(dt,{poster:c})]}),Object(n.jsx)(Ge,{}),Object(n.jsx)(Ve,{})]})}var dt=Object(P.h)((function(e){var t=e.poster,c=Object(s.useCallback)((function(c,n){e.history.push("/user/".concat(t.userId)),q.dispatch({type:"activeSwitch",active:c}),void 0!==n&&q.dispatch({type:"collectActive",active:n})}),[t,e.history]);return Object(n.jsxs)("div",{className:"posterInfo",children:[Object(n.jsxs)("div",{className:"posterInfo-user",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.userId),children:Object(n.jsx)("i",{className:"post-avatar",style:{backgroundImage:"url(".concat(t.avatar,")")}})}),Object(n.jsxs)("div",{className:"poster-userInfo",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.userId),children:Object(n.jsx)("h3",{children:t.name})}),Object(n.jsx)("span",{children:t.sign})]})]}),Object(n.jsxs)("div",{children:[Object(n.jsxs)("ul",{className:"posterInfo-other",children:[Object(n.jsxs)("li",{onClick:function(){return c(1)},children:[Object(n.jsx)("span",{children:"\u56de\u7b54"}),Object(n.jsx)("br",{}),t.commentCount]}),Object(n.jsxs)("li",{onClick:function(){return c(2)},children:[Object(n.jsx)("span",{children:"\u63d0\u95ee"}),Object(n.jsx)("br",{}),t.postCount]}),Object(n.jsxs)("li",{onClick:function(){return c(4,2)},children:[Object(n.jsx)("span",{children:"\u5173\u6ce8\u8005"}),Object(n.jsx)("br",{}),t.fans]})]}),Object(n.jsx)(ce,{careInfo:t})]})]})}));var bt=c(349),mt=c(350),Ot=(c(77),function(e){var t=e.userId,c=Object(P.g)().id,a=Object(s.useState)([]),i=Object(l.a)(a,2),r=i[0],o=i[1];Object(s.useEffect)((function(){var e=M.subscribe((function(){return o(M.getState().myCares)}));return function(){return e()}}),[]);var j=Object(s.useRef)();Object(s.useEffect)((function(){C.a.get("/api/get-care/".concat(t)).then((function(e){M.dispatch({type:"getCare",myCares:e.data.myCares})})),C.a.get("/api/invite/".concat(c)).then((function(e){L.dispatch({type:"getInitial",inviteList:e.data.inviteList})}))}),[c,t]),Object(s.useEffect)((function(){var e=document.querySelector(".invite-outer");return e.onmousewheel=function(e){e.preventDefault()},function(){return e.onmousewheel=null}}),[]);var u=Object(s.useCallback)((function(){L.dispatch({type:"invite",invite:!1})}),[]);return Object(s.useEffect)((function(){function e(e){e.stopPropagation(),e.target!==j.current&&e.target!==document.body||u()}return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}}),[u]),Object(n.jsx)("div",{className:"invite-outer",ref:j,children:Object(n.jsxs)("div",{className:"invite-main",children:[Object(n.jsxs)("div",{className:"invite-header",children:[Object(n.jsxs)("h2",{children:["\u9009\u62e9\u60f3\u8981\u9080\u8bf7\u7684\u7528\u6237",Object(n.jsx)("span",{children:" * \u53ea\u80fd\u9080\u8bf7\u5173\u6ce8\u7528\u6237\uff0c\u8bf7\u591a\u591a\u5145\u5b9e\u5173\u6ce8\u5217\u8868\u5427\uff01"})]}),Object(n.jsx)(ee.a,{type:"primary",size:"middle",onClick:u,children:"\u5b8c\u6210"})]}),Object(n.jsxs)("ul",{className:"invite-list",children:[0===r.length&&Object(n.jsx)("li",{className:"no-invite",children:Object(n.jsx)("span",{children:"\u8fd8\u6ca1\u6709\u5173\u6ce8\u8fc7\u7528\u6237\uff0c\u9080\u8bf7\u5217\u8868\u592a\u51b7\u6e05\u5566\uff01"})}),r.map((function(e){return Object(n.jsx)("li",{children:Object(n.jsx)(ft,{invite:e})},e.createdAt)}))]})]})})});function ft(e){var t=e.invite,c=Object(P.g)().id,a=Object(s.useState)(!1),i=Object(l.a)(a,2),r=i[0],o=i[1],j=Object(s.useState)(!1),u=Object(l.a)(j,2),d=u[0],b=u[1];Object(s.useEffect)((function(){function e(){var e=(L.getState().inviteList||[]).some((function(e){return e.targetId===t.careId}));o(e)}e();var c=L.subscribe((function(){return e()}));return function(){return c()}}),[t]);var m=Object(s.useCallback)((function(e){C.a.post("/api/invite",{type:e,postId:c,targetId:t.careId,targetName:t.careName}).then((function(e){L.dispatch({type:"upDateInvite",inviteList:e.data.newInvites})}))}),[c,t]);return Object(n.jsxs)("div",{className:"invite-item",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.careId),children:Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(t.avatar,")")},className:"invite-avatar"})}),Object(n.jsxs)("div",{className:"invite-userInfo",children:[Object(n.jsx)(Q.b,{to:"/user/".concat(t.careId),children:Object(n.jsxs)("h4",{children:[t.careName,Object(n.jsxs)("span",{children:["  -  ",t.industry]})]})}),Object(n.jsx)("span",{children:t.sign})]}),r?Object(n.jsx)(ee.a,{type:"ghost",onClick:function(){return m("revoke")},style:{width:"100px",color:"rgb(138 138 138)"},onMouseEnter:function(){return b(!0)},onMouseLeave:function(){return b(!1)},children:d?"\u53d6\u6d88\u9080\u8bf7":"\u5df2\u9080\u8bf7"}):Object(n.jsx)(ee.a,{type:"ghost",style:{width:"100px",borderColor:"#40a9ff",color:"#40a9ff"},onClick:function(){return m("active")},children:"\u9080\u8bf7\u56de\u7b54"})]})}var ht=function(){var e=Object(P.g)().id,t=void 0===e?1:e,c=Object(s.useState)(L.getState()),a=Object(l.a)(c,2),i=a[0],r=a[1],j=Object(s.useState)(!1),u=Object(l.a)(j,2),d=u[0],b=u[1],m=Object(s.useState)(!0),O=Object(l.a)(m,2),f=O[0],h=O[1];return Object(s.useEffect)((function(){var e=L.subscribe((function(){return b(L.getState().invite)}));return function(){return e()}}),[]),Object(s.useEffect)((function(){(function(){var e=Object(at.a)(st.a.mark((function e(){var c;return st.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get("/api/post-page/".concat(t));case 2:c=e.sent,L.dispatch(Object(o.a)({type:"getInitial"},c.data)),h(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()();var e=L.subscribe((function(){return r(L.getState())}));return function(){return e()}}),[t]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(re,{page:"post",children:Object(n.jsx)(pt,{data:i})}),Object(n.jsxs)(xt,{children:[Object(n.jsx)(vt,{data:i,loading:f}),Object(n.jsx)(yt,{data:i})]}),Object(n.jsx)(it,{data:i,loading:f}),d&&Object(n.jsx)(Ot,{id:t})]})};function pt(e){var t=e.data,c=t.post||{},a=Object(s.useCallback)((function(){L.dispatch({type:"writeAnswer",writeAnswer:!t.writeAnswer}),document.documentElement.scrollTop=0,document.querySelector(".nav-slider-outer").style.top="0px"}),[t]);return Object(n.jsxs)("div",{className:"post-nav-slider",children:[Object(n.jsx)("h1",{title:c.title,children:c.title}),Object(n.jsxs)("div",{className:"post-footer-list",children:[Object(n.jsx)(gt,{data:t}),Object(n.jsxs)("div",{className:"answer",onClick:a,children:[Object(n.jsx)(O.a,{}),"\u5199\u56de\u7b54"]})]})]})}function xt(e){return Object(n.jsx)("div",{className:"post-info post-top",children:e.children})}function vt(e){var t=e.data,c=t.commenterInfo||[],a=e.data.post||{},i=Object(s.useState)(!1),r=Object(l.a)(i,2),o=r[0],j=r[1],u=Object(s.useState)(!0),b=Object(l.a)(u,2),m=b[0],f=b[1],h=Object(s.useState)(0),p=Object(l.a)(h,2),x=p[0],v=p[1],g=c.filter((function(e){return"delete"!==e.status})),y=Object(s.useCallback)((function(){L.dispatch({type:"writeAnswer",writeAnswer:!t.writeAnswer})}),[t]);Object(s.useEffect)((function(){var e=document.querySelector(".post-content");x>=72&&(e.style.height="72px",j(!0))}),[x,e.loading]),Object(s.useEffect)((function(){var e=document.querySelector(".post-content >span");e&&a.content&&(e.innerHTML="{"!==a.content[0]?a.content:JSON.parse(a.content).html,v(e.getBoundingClientRect().height))}),[a,e]);var C=Object(s.useCallback)((function(){var e=document.querySelector(".post-content"),t=document.querySelector(".post-content span");m?(e.style.display="block",e.style.height=t.getBoundingClientRect().height+3+"px",f(!1)):(e.style.display="-webkit-box",e.style.height="72px",f(!0))}),[m]),k=Object(s.useCallback)((function(){void 0!==t.cookieUser?L.dispatch({type:"invite",invite:!0}):N.dispatch({type:"toSign",sign:!1})}),[t]);return Object(n.jsxs)("div",{className:"post-main",children:[Object(n.jsx)(Fe.a,{title:{width:300},paragraph:!1,loading:e.loading,round:!0,children:Object(n.jsx)("h1",{children:a.title})}),Object(n.jsx)(Fe.a,{active:!0,loading:e.loading,paragraph:{rows:2},round:!0,title:!1,children:Object(n.jsx)("p",{className:"post-content",children:Object(n.jsx)("span",{})})}),Object(n.jsxs)("div",{className:"post-footer-list",children:[Object(n.jsx)(gt,{data:t}),Object(n.jsxs)("div",{className:"answer",onClick:y,children:[Object(n.jsx)(O.a,{}),"\u5199\u56de\u7b54"]}),Object(n.jsxs)("div",{className:"admire-qus",onClick:k,children:[Object(n.jsx)(bt.a,{}),"\u9080\u8bf7\u56de\u7b54"]}),Object(n.jsxs)("ul",{className:"other-info",children:[Object(n.jsxs)("li",{className:"comments-count",children:[Object(n.jsx)(d.a,{}),Object(n.jsxs)("span",{children:[g.length,"\xa0\u6761\u56de\u7b54"]})]}),Object(n.jsxs)("li",{className:"pageview",children:[Object(n.jsx)(mt.a,{}),Object(n.jsxs)("span",{children:[a.pageview,"\xa0\u6d4f\u89c8\u91cf"]})]}),o&&Object(n.jsx)("li",{className:"hide",onClick:C,children:Object(n.jsx)("span",{children:m?"\u5c55\u5f00":"\u6536\u8d77"})})]})]})]})}function gt(e){var t=e.data,c=Object(P.g)().id,a=Object(s.useState)(L.getState().attention),i=Object(l.a)(a,2),r=i[0],o=i[1],j=Object(s.useRef)(),u=Object(s.useCallback)((function(){void 0===t.cookieUser?N.dispatch({type:"toSign",sign:!1}):L.dispatch({type:"toAttention",attention:!r,pageId:c})}),[r,c,t]);return Object(s.useEffect)((function(){var e=L.subscribe((function(){return o(L.getState().attention)}));return r&&(j.current.onmouseenter=function(){j.current.innerText="\u53d6\u6d88\u5173\u6ce8"},j.current.onmouseleave=function(){j.current.innerText="\u5df2\u5173\u6ce8"}),function(){e(),j.current.onmouseenter=null,j.current.onmouseleave=null}}),[r,c]),Object(n.jsx)("div",{className:r?"revoke":"guanzhu",onClick:u,ref:j,children:r?"\u5df2\u5173\u6ce8":"\u5173\u6ce8\u95ee\u9898"})}function yt(e){var t=e.data,c=(t.commenterInfo||[]).filter((function(e){return"delete"!==e.status})),s=t.post&&1*t.post.createdAt,a=V()(s).endOf().fromNow(!0)+"\u524d";return Object(n.jsxs)("div",{className:"post-other",children:[Object(n.jsxs)("ul",{children:[Object(n.jsxs)("li",{className:"post-other-line",children:[Object(n.jsx)("span",{children:"\u5173\u6ce8\u6570"}),Object(n.jsx)("br",{}),t.attentionLength]}),Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{children:"\u56de\u7b54\u6570"}),Object(n.jsx)("br",{}),c.length]})]}),Object(n.jsxs)("div",{className:"post-other-time",children:[Object(n.jsx)("span",{children:"\u53d1\u5e16\u65f6\u95f4\uff1a"}),1*parseInt(a)>1&&/\u5929/g.test(a)?V()(s).format("YYYY-MM-DD HH:mm:ss"):a]})]})}var Ct=function(){var e=Object(s.useState)(E.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1];return Object(s.useEffect)((function(){var e=E.subscribe((function(){return a(E.getState())}));return function(){return e()}}),[]),Object(n.jsxs)(n.Fragment,{children:[c.question&&Object(n.jsx)(xe,{}),Object(n.jsx)(ht,{})]})},kt=c(11),Nt=c(352),It=c(353),St=c(354),At=c(355),Et=c(325),wt=c(321),Lt=c(351),Dt=(c(299),function(){var e=Object(s.useState)(q.getState()),t=Object(l.a)(e,2),c=t[0],a=t[1],i=c.userInfo,r=void 0===i?{}:i;Object(s.useEffect)((function(){var e=q.subscribe((function(){return a(q.getState())}));return function(){return e()}}),[]);var o=Object(s.useCallback)((function(){q.dispatch({type:"editEnd",edit:!1})}),[]);return Object(n.jsx)("div",{className:"edit-container-bg",children:Object(n.jsx)("div",{className:"edit-outer",children:Object(n.jsx)("form",{action:"/api/edit-userInfo",method:"post",className:"edit-form",children:Object(n.jsxs)("ul",{children:[Object(n.jsxs)("li",{children:[Object(n.jsx)("h2",{children:"\u738b\u53f8\u5f92"}),Object(n.jsx)("span",{style:{fontWeight:"100"},children:"* \u9f20\u6807\u79fb\u5230\u7528\u6237\u5934\u50cf\u5373\u53ef\u4fee\u6539\u5934\u50cf"}),Object(n.jsx)(ee.a,{onClick:o,type:"primary",children:"\u4fee\u6539\u5b8c\u6210"})]}),Object(n.jsx)(qt,{sex:r.sex}),Object(n.jsx)(Ft,{birthday:r.birthday}),Object(n.jsx)(Mt,{address:r.address}),Object(n.jsx)(Ut,{sign:r.sign}),Object(n.jsx)(Tt,{industry:r.industry}),Object(n.jsx)(Pt,{introduction:r.introduction}),Object(n.jsx)(Yt,{sociality:r.sociality})]})})})})});function qt(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.sex),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useCallback)((function(){i(!a)}),[a]),b=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"sex",sex:j}).then((function(e){q.dispatch({type:"editUserInfo",sex:j}),i(!1)}))}),[j]);return Object(n.jsxs)("li",{className:"edit-sex",children:[Object(n.jsx)("span",{children:"\u6027\u522b"}),a?Object(n.jsxs)("div",{children:[Object(n.jsxs)(Et.a.Group,{value:j,onChange:function(){return u("man"===j?"female":"man")},children:[Object(n.jsx)(Et.a,{value:"man",checked:"man"===e.sex,children:"\u7537"}),Object(n.jsx)(Et.a,{value:"female",checked:"female"===e.sex,children:"\u5973"})]}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:b,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){return i(!1)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:"man"===j?"\u7537":"\u5973"}),Object(n.jsx)(Lt.a,{onClick:d,style:{color:"#40a9ff"}})]})]})}function Ut(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.sign),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useCallback)((function(){i(!a)}),[a]),h=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"sign",sign:j}).then((function(e){q.dispatch({type:"editUserInfo",sign:j}),i(!1)}))}),[j]),p=Object(s.useCallback)((function(e){e.target.value.length>30?O(!0):(O(!1),u(e.target.value))}),[]);return Object(n.jsxs)("li",{className:"edit-sign",children:[Object(n.jsx)("span",{children:"\u4e00\u53e5\u8bdd\u4ecb\u7ecd"}),a?Object(n.jsxs)("div",{children:[Object(n.jsx)(Z.a,{value:j,onInput:p,style:m?{borderColor:"red"}:{}}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:h,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){i(!1),u(e.sign)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:j}),Object(n.jsx)(Lt.a,{onClick:f,style:{color:"#40a9ff"}})]})]})}function Mt(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.address),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useCallback)((function(){i(!a)}),[a]),h=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"address",address:j}).then((function(e){q.dispatch({type:"editUserInfo",address:j}),i(!1)}))}),[j]),p=Object(s.useCallback)((function(e){e.target.value.length>10?O(!0):(O(!1),u(e.target.value))}),[]);return Object(n.jsxs)("li",{className:"edit-address",children:[Object(n.jsx)("span",{children:"\u73b0\u5c45\u5730"}),a?Object(n.jsxs)("div",{children:[Object(n.jsx)(Z.a,{value:j,onInput:p,style:m?{borderColor:"red"}:{}}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:h,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){i(!1),u(e.address)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:e.address}),Object(n.jsx)(Lt.a,{onClick:f,style:{color:"#40a9ff"}})]})]})}function Ft(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.birthday),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useCallback)((function(){i(!a)}),[a]),b=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"birthday",birthday:j}).then((function(e){q.dispatch({type:"editUserInfo",birthday:j}),i(!1)}))}),[j]),m=Object(s.useCallback)((function(e){var t=document.querySelector(".edit-birthday input");u(t.value)}),[]);return Object(n.jsxs)("li",{className:"edit-birthday",children:[Object(n.jsx)("span",{children:"\u751f\u65e5"}),a?Object(n.jsxs)("div",{children:[Object(n.jsx)(wt.a,{onChange:m}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:b,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){i(!1),u(e.birthday)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:j.slice(5)}),Object(n.jsx)(Lt.a,{onClick:d,style:{color:"#40a9ff"}})]})]})}function Tt(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.industry),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useCallback)((function(){i(!a)}),[a]),h=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"industry",industry:j}).then((function(e){q.dispatch({type:"editUserInfo",industry:j}),i(!1)}))}),[j]),p=Object(s.useCallback)((function(e){e.target.value.length>10?O(!0):(O(!1),u(e.target.value))}),[]);return Object(n.jsxs)("li",{className:"edit-industry",children:[Object(n.jsx)("span",{children:"\u6240\u5728\u884c\u4e1a"}),a?Object(n.jsxs)("div",{children:[Object(n.jsx)(Z.a,{value:j,onInput:p,style:m?{borderColor:"red"}:{}}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:h,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){i(!1),u(e.industry)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:e.industry}),Object(n.jsx)(Lt.a,{onClick:f,style:{color:"#40a9ff"}})]})]})}var Ht=Z.a.TextArea;function Pt(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.introduction),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useCallback)((function(){i(!a)}),[a]),h=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"introduction",introduction:j}).then((function(e){q.dispatch({type:"editUserInfo",introduction:j}),i(!1)}))}),[j]),p=Object(s.useCallback)((function(e){e.target.value.length>150?O(!0):(O(!1),u(e.target.value))}),[]);return Object(n.jsxs)("li",{className:"edit-introduction",children:[Object(n.jsx)("span",{children:"\u4e2a\u4eba\u7b80\u4ecb"}),a?Object(n.jsxs)("div",{children:[Object(n.jsx)(Ht,{value:j,onInput:p,style:m?{borderColor:"red"}:{}}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:h,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){i(!1),u(e.introduction)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:j}),Object(n.jsx)(Lt.a,{onClick:f,style:{color:"#40a9ff"}})]})]})}function Yt(e){var t=Object(s.useState)(!1),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(e.sociality),o=Object(l.a)(r,2),j=o[0],u=o[1],d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useCallback)((function(){i(!a)}),[a]),h=Object(s.useCallback)((function(){C.a.post("/api/edit-userInfo",{type:"sociality",sociality:j}).then((function(e){q.dispatch({type:"editUserInfo",sociality:j}),i(!1)}))}),[j]),p=Object(s.useCallback)((function(e){e.target.value.length>50?O(!0):(O(!1),u(e.target.value))}),[]);return Object(n.jsxs)("li",{className:"edit-industry",children:[Object(n.jsx)("span",{children:"\u793e\u4ea4\u5730\u5740"}),a?Object(n.jsxs)("div",{children:[Object(n.jsx)(Z.a,{value:j,onInput:p,style:m?{borderColor:"red"}:{}}),Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)(ee.a,{size:"small",type:"primary",onClick:h,children:"\u4fdd\u5b58"}),Object(n.jsx)(ee.a,{size:"small",onClick:function(){i(!1),u(e.sociality)},children:"\u53d6\u6d88"})]})]}):Object(n.jsxs)("div",{className:"saveEdit",children:[Object(n.jsx)("span",{children:j}),Object(n.jsx)(Lt.a,{onClick:f,style:{color:"#40a9ff"}})]})]})}var zt=function(){return Object(n.jsx)("div",{className:"user-page ",children:Object(n.jsx)("div",{className:"user-header-bg",children:Object(n.jsx)(Rt,{})})})};function Rt(){var e=Object(s.useState)({}),t=Object(l.a)(e,2),c=t[0],a=t[1],i=c.userInfo||{},r=Object(s.useState)(!0),o=Object(l.a)(r,2),j=o[0],u=o[1];Object(s.useEffect)((function(){c.userInfo&&u(!1)}),[c.userInfo]),Object(s.useEffect)((function(){var e=q.subscribe((function(){return a(q.getState())}));return function(){return e()}}),[]);var d=Object(s.useState)(i.avatar),b=Object(l.a)(d,2),m=b[0],O=b[1],f=Object(s.useState)(!1),h=Object(l.a)(f,2),p=h[0],x=h[1],v=Object(s.useCallback)((function(e){var t=new FormData;t.append("avatar",e.target.files[0]),C.a.post("/api/user-avatar/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){O(e.data)}))}),[]),g=Object(s.useCallback)((function(){document.querySelector('[name="avatar"]').click()}),[]);Object(s.useEffect)((function(){O(i.avatar)}),[i]),Object(s.useEffect)((function(){function e(){E.dispatch({type:"hoverAvatar",hover:!0})}function t(){E.dispatch({type:"hoverAvatar",hover:!1})}var c=document.querySelector(".User-avatar");c.addEventListener("mouseenter",e),c.addEventListener("mouseleave",t);var n=E.subscribe((function(){return x(E.getState().hover)}));return function(){n(),c.removeEventListener("mouseenter",e),c.removeEventListener("mouseleave",t)}}),[i]);var y=Object(s.useState)(!1),k=Object(l.a)(y,2),N=k[0],I=k[1],S=Object(s.useCallback)((function(){I(!N)}),[N]),A=Object(s.useCallback)((function(){q.dispatch({type:"editState",edit:!0})}),[]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"user-header",children:[Object(n.jsx)("div",{className:"UserCover-bg"}),Object(n.jsx)("div",{className:"User-avatar",style:{backgroundImage:"url(".concat(m,")")},children:Object(n.jsxs)(Fe.a,{loading:j,active:!0,avatar:{size:140,shape:"square"},children:[Object(n.jsx)("input",{type:"file",name:"avatar",style:{display:"none"},onChange:v}),p&&i.name===c.cookieUser&&Object(n.jsxs)("div",{className:"avatarMouseEnter",onClick:g,children:[Object(n.jsx)(Nt.a,{style:{fontSize:"18px"}}),Object(n.jsx)("span",{children:"\u66f4\u6362\u5934\u50cf"})]})]})}),Object(n.jsxs)("div",{className:N?"UserDetailed UserDetailed-flod":"UserDetailed",children:[Object(n.jsx)("div",{className:"User-data",children:Object(n.jsxs)(Fe.a,{loading:j,active:!0,round:!0,children:[Object(n.jsx)("h2",{children:i.name}),Object(n.jsx)("span",{className:"sign",children:i.sign}),Object(n.jsx)(Qt,{flod:N}),Object(n.jsx)(_t,{flod:N})]})}),Object(n.jsx)("div",{className:"User-data-bottom",children:Object(n.jsxs)(Fe.a,{loading:j,active:!0,round:!0,title:!1,paragraph:{width:[300,600]},children:[N?Object(n.jsxs)("span",{onClick:S,children:[Object(n.jsx)(ke.a,{}),"  \u6536\u8d77\u8be6\u7ec6\u8d44\u6599"]}):Object(n.jsxs)("span",{onClick:S,children:[Object(n.jsx)(Ce.a,{}),"  \u67e5\u770b\u8be6\u7ec6\u8d44\u6599"]}),c.cookieUser===i.name?Object(n.jsx)("div",{className:"user-editing",onClick:A,children:"\u7f16\u8f91\u4e2a\u4eba\u8d44\u6599"}):Object(n.jsx)("div",{className:"other-user",children:Object(n.jsx)(ce,{careInfo:c.userInfo})})]})})]})]}),c.edit&&Object(n.jsx)(Dt,{})]})}function _t(e){var t=e.flod,c=Object(s.useState)({}),a=Object(l.a)(c,2),i=a[0],r=a[1],o=i.userInfo||{};return Object(s.useEffect)((function(){var e=q.subscribe((function(){return r(q.getState())}));return function(){return e()}}),[]),Object(n.jsx)(n.Fragment,{children:Object(n.jsxs)("ul",{className:t?"User-data-base":"User-data-base active",children:[Object(n.jsxs)("li",{children:[Object(n.jsx)(It.a,{}),Object(n.jsxs)("span",{children:[" \xa0 \xa0",o.sociality]})," "]}),Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{style:{color:"#cacaca"},children:"|"}),"man"===o.sex?Object(n.jsx)(St.a,{style:{marginLeft:"15px",color:"#0084FF"}}):Object(n.jsx)(At.a,{style:{marginLeft:"15px",color:"#e49eab"}})]})]})})}function Qt(e){var t=e.flod,c=Object(s.useState)({}),a=Object(l.a)(c,2),i=a[0],r=a[1],o=i.userInfo||{};return Object(s.useEffect)((function(){var e=q.subscribe((function(){return r(q.getState())}));return function(){return e()}}),[]),Object(n.jsxs)("ul",{className:t?"User-data-list active":"User-data-list",children:[Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{children:"\u73b0\u5c45\u5730"}),Object(n.jsx)("span",{children:o.address})]}),Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{children:"\u751f\u65e5"}),Object(n.jsx)("span",{children:o.birthday&&o.birthday.slice(5)})]}),Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{children:"\u6240\u5728\u884c\u4e1a"}),Object(n.jsx)("span",{children:o.industry})]}),Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{children:"\u4e2a\u4eba\u7b80\u4ecb"}),Object(n.jsx)("span",{children:o.introduction})]}),Object(n.jsxs)("li",{children:[Object(n.jsx)("span",{children:"\u793e\u4ea4\u5730\u5740"}),Object(n.jsx)("span",{children:o.sociality})]})]})}function Bt(){return Object(n.jsxs)("div",{className:"toolbar",children:[Object(n.jsx)(Jt,{}),Object(n.jsx)(Ve,{})]})}var Jt=Object(P.h)((function(){var e=Object(s.useState)(q.getState()||{}),t=Object(l.a)(e,2),c=t[0],a=t[1],i=c.userInfo,r=void 0===i?{}:i,o=c.cookieUser===r.name;Object(s.useEffect)((function(){var e=q.subscribe((function(){return a(q.getState())}));return function(){return e()}}),[]);var j=Object(s.useCallback)((function(e,t){q.dispatch({type:"activeSwitch",active:e}),q.dispatch({type:"careActive",careActive:t})}),[]),u=Object(s.useCallback)((function(e,t){q.dispatch({type:"activeSwitch",active:e}),q.dispatch({type:"collectActive",collectActive:t})}),[]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("div",{className:"person-honor",children:[Object(n.jsx)("h4",{children:"\u4e2a\u4eba\u6210\u5c31"}),Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{children:Object(n.jsx)(x.a,{style:{fontSize:"16px"}})}),Object(n.jsxs)("li",{children:[Object(n.jsxs)("span",{children:["\u83b7\u5f97\u4e86 ",r.agree," \u6b21\u8d5e\u540c"]}),Object(n.jsxs)("span",{children:[r.collect," \u6b21\u6536\u85cf"]}),Object(n.jsxs)("span",{children:[r.favorite," \u6b21\u559c\u6b22"]})]})]})]}),Object(n.jsxs)("div",{className:"user-score",children:[Object(n.jsxs)("div",{className:"likes",onClick:function(){return j(4,1)},children:[Object(n.jsx)("h4",{children:"\u5173\u6ce8\u4e86"}),Object(n.jsx)("span",{children:r.care})]}),Object(n.jsxs)("div",{className:"fans",onClick:function(){return j(4,2)},children:[Object(n.jsx)("h4",{children:"\u5173\u6ce8\u8005"}),Object(n.jsx)("span",{children:r.fans})]})]}),Object(n.jsx)("div",{children:Object(n.jsxs)("ul",{className:"user-bar-list",children:[Object(n.jsxs)("li",{onClick:function(){return j(4,0)},children:[Object(n.jsx)("span",{children:"\u5173\u6ce8\u7684\u95ee\u9898"}),Object(n.jsx)("span",{children:c.attentionDynamic&&c.attentionDynamic.length})]}),Object(n.jsxs)("li",{onClick:function(){return u(5,0)},children:[Object(n.jsx)("span",{children:"\u6536\u85cf\u7684\u95ee\u9898"}),Object(n.jsx)("span",{children:c.collectQues&&c.collectQues.length})]}),Object(n.jsxs)("li",{onClick:function(){return u(5,1)},children:[Object(n.jsx)("span",{children:"\u6536\u85cf\u7684\u56de\u7b54"}),Object(n.jsx)("span",{children:c.collectComment&&c.collectComment.length})]}),Object(n.jsxs)("li",{onClick:function(){return j(4,1)},children:[Object(n.jsxs)("span",{children:[o?"\u6211":"man"===r.sex?"\u4ed6":"\u5979","\u5173\u6ce8\u7684\u4eba"]}),Object(n.jsx)("span",{children:r.care})]})]})})]})})),Wt=c(356);function Gt(e){var t=e.dynamicList,c=e.state,a=c.userInfo||{},i=c.cookieUser===a.name,r=Object(s.useState)(q.getState().careActive||0),o=Object(l.a)(r,2),j=o[0],u=o[1];Object(s.useEffect)((function(){var e=q.subscribe((function(){return u(q.getState().careActive)}));return function(){return e()}}));var d=Object(s.useCallback)((function(e){q.dispatch({type:"careActive",careActive:e})}),[]),b=-1;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"dynamicCareList",children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{onClick:function(){return d(0)},className:0===j?"careListActive":"",children:"\u5173\u6ce8\u7684\u95ee\u9898"}),Object(n.jsxs)("li",{onClick:function(){return d(1)},className:1===j?"careListActive":"",children:[i?"\u6211":"man"===c.userInfo.sex?"\u4ed6":"\u5979","\u5173\u6ce8\u7684\u4eba"]}),Object(n.jsxs)("li",{onClick:function(){return d(2)},className:2===j?"careListActive":"",children:["\u5173\u6ce8",i?"\u6211":"man"===c.userInfo.sex?"\u4ed6":"\u5979","\u7684\u4eba"]})]})}),Object(n.jsx)("div",{children:Object(n.jsxs)("ul",{className:"posts user-Dynamic cares",children:[0===j&&t.map((function(t,c){return"delete"!==t.status?(b++,Object(n.jsx)(s.Fragment,{children:"attention"===t.style&&Object(n.jsx)(oc,{item:t,state:e.state,idx:b})},c)):""})),0!==j&&Object(n.jsx)(Vt,{active:j})]})})]})}function Vt(e){var t=e.active,c=Object(P.g)().id,a=Object(s.useState)(M.getState()||{}),i=Object(l.a)(a,2),r=i[0],j=i[1],u=r.myCares,d=void 0===u?[]:u,b=1===t?r.itCaresList:r.recevies;Object(s.useEffect)((function(){C.a.get("/api/get-care/".concat(c)).then((function(e){var t=e.data;M.dispatch(Object(o.a)({type:"getCare",cares:t.myCares},t))}));var e=M.subscribe((function(){return j(M.getState())}));return function(){return e()}}),[c]);var m=Object(s.useCallback)((function(e){e.target.innerText="\u53d6\u6d88\u5173\u6ce8"}),[]),O=Object(s.useCallback)((function(e){e.target.innerText="\u5df2\u5173\u6ce8"}),[]),f=Object(s.useCallback)((function(e){var t=e.type,c=e.item;void 0!==r.cookieUser?(M.dispatch({type:"updateCare",id:c.userId}),C.a.post("/api/care",{type:t,careId:c.userId}).catch((function(e){401===e.response.status&&N.dispatch({type:"toSign",sign:!1})}))):N.dispatch({type:"toSign",sign:!1})}),[r]);return Object(n.jsx)(n.Fragment,{children:b&&b.map((function(e){var t=d.find((function(t){return t.careId===e.userId}));return Object(n.jsxs)("li",{className:"careList",children:[Object(n.jsx)("div",{children:Object(n.jsx)(Q.b,{to:"/user/"+e.userId,children:Object(n.jsx)("i",{style:{backgroundImage:"url(".concat(e.avatar,")")},className:"careAvatar"})})}),Object(n.jsxs)("div",{children:[Object(n.jsxs)(Q.b,{to:"/user/"+e.userId,className:"cares-name",children:[Object(n.jsx)("h3",{children:e.name}),"man"===e.sex?Object(n.jsx)(St.a,{style:{marginLeft:"15px",color:"#0084FF"}}):Object(n.jsx)(At.a,{style:{marginLeft:"15px",color:"#e49eab"}})]}),Object(n.jsx)("span",{className:"careSign",children:e.sign}),Object(n.jsxs)("ul",{className:"careinfo",children:[Object(n.jsx)("li",{children:Object(n.jsxs)("span",{children:[e.commentCount," \u56de\u7b54"]})}),Object(n.jsx)("li",{children:Object(n.jsxs)("span",{children:[e.agree," \u8d5e\u540c"]})}),Object(n.jsx)("li",{children:Object(n.jsxs)("span",{children:[e.fans," \u5173\u6ce8\u8005"]})})]})]}),Object(n.jsx)("div",{className:"careButton",children:t?Object(n.jsx)("button",{className:"active",onMouseEnter:m,onMouseLeave:O,onClick:function(){return f({type:"reCare",item:e})},children:"\u5df2\u5173\u6ce8"}):Object(n.jsxs)("button",{className:"unactive",onClick:function(){return f({type:"toCare",item:e})},children:[Object(n.jsx)(Wt.a,{})," \u5173\u6ce8","man"===e.sex?"\u4ed6":"\u5979"]})})]},e.createdAt)}))})}function Kt(e){var t=Object(s.useState)(q.getState()||{}),c=Object(l.a)(t,2),a=c[0],i=c[1],r=Object(s.useState)(q.getState().collectActive||0),o=Object(l.a)(r,2),j=o[0],u=o[1];Object(s.useEffect)((function(){var e=q.subscribe((function(){u(q.getState().collectActive),i(q.getState())}));return function(){return e()}}),[e]);var d=e.dynamicList,b=Object(s.useCallback)((function(e){q.dispatch({type:"collectActive",collectActive:e})}),[]),m=-1,O=-1;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"dynamicCareList collectHead",children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{onClick:function(){return b(0)},className:0===j?"careListActive":"",children:"\u6536\u85cf\u7684\u95ee\u9898"}),Object(n.jsx)("li",{onClick:function(){return b(1)},className:1===j?"careListActive":"",children:"\u6536\u85cf\u7684\u56de\u7b54"})]})}),Object(n.jsx)("div",{children:Object(n.jsx)("ul",{className:"posts user-Dynamic collect",children:d.map((function(e,t){return 0===j&&"delete"!==e.status&&"question"===e.type?(m++,Object(n.jsx)(s.Fragment,{children:Object(n.jsx)($t,{item:e,state:a,idx:m})},t)):1===j&&"delete"!==e.status&&"comment"===e.type?(O++,Object(n.jsx)(s.Fragment,{children:Object(n.jsx)(Xt,{item:e,state:a,idx:O})},t)):""}))})})]})}function $t(e){var t=e.idx,c=Object(s.useState)(q.getState()||{}),a=Object(l.a)(c,2),i=a[0],r=a[1];Object(s.useEffect)((function(){var e=q.subscribe((function(){return r(q.getState())}));return function(){return e()}}),[t]);var o=e.item,j=1*(o.likeAt||o.createdAt),u=V()(j).endOf().fromNow(!0)+"\u524d",d=Object(s.useState)(!1),b=Object(l.a)(d,2),m=b[0],O=b[1];return Object(s.useEffect)((function(){ec(o,t,O)}),[o]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"dynamicList-header",children:[Object(n.jsx)("span",{children:"\u6536\u85cf\u4e86\u95ee\u9898"}),Object(n.jsx)("span",{children:1*parseInt(u)>1&&/\u5929/g.test(u)?new Date(j).toLocaleDateString().slice(5):u})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(o.postId),children:o.title}),Object(n.jsx)("p",{className:"post-content",children:Object(n.jsx)("span",{children:Zt(o)})})]}),Object(n.jsx)(Me,{type:"question",post:o,idx:t,state:i,footer:m})]},o.likeAt||o.createdAt)}function Xt(e){var t=e.idx,c=Object(s.useState)(q.getState()||{}),a=Object(l.a)(c,2),i=a[0],r=a[1];Object(s.useEffect)((function(){var e=q.subscribe((function(){return r(q.getState())}));return function(){return e()}}),[t]);var o=e.item,j=o.avatar,u=1*(o.likeAt||o.createdAt),d=V()(u).endOf().fromNow(!0)+"\u524d",b=V()(1*o.createdAt).endOf().fromNow(!0)+"\u524d",m=Object(s.useState)(!1),O=Object(l.a)(m,2),f=O[0],h=O[1];return Object(s.useEffect)((function(){ec(o,t,h)}),[o]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"dynamicList-header",children:[Object(n.jsx)("span",{children:"\u6536\u85cf\u4e86\u56de\u7b54"}),Object(n.jsx)("span",{children:1*parseInt(d)>1&&/\u5929/g.test(d)?new Date(u).toLocaleDateString().slice(5):d})]}),Object(n.jsx)("div",{className:"content-div",name:"content",children:Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(o.postId),children:o.title})}),Object(n.jsxs)("div",{className:"commenter-info dynamic-comment",children:[Object(n.jsx)("i",{className:"commenter-avatar",style:{backgroundImage:"url(".concat(j,")")}}),Object(n.jsxs)("div",{className:"commenter-flag",children:[Object(n.jsx)(Q.b,{className:"commenter-name",to:"/user/".concat(o.userId),children:o.name}),Object(n.jsx)("span",{className:"commenter-sign",children:o.sign}),Object(n.jsx)(He,{state:i,post:o,type:"comment"})]})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)("p",{children:Object(n.jsx)("span",{children:Zt(o)})}),Object(n.jsxs)("span",{className:"answerAt",children:["\u53d1\u5e03\u4e8e \xa0",parseInt(b)>=1&&/\u5929/g.test(b)?V()(1*o.createdAt).format("YYYY-MM-DD HH:mm:ss"):b]}),Object(n.jsx)("div",{className:"commenter-footer",children:Object(n.jsx)(Me,{type:"comment",comment:o,idx:t,state:i,footer:f})})]})]},o.likeAt||o.createdAt)}function Zt(e){if(e.content)return"{"!==e.content[0]?e.content:JSON.parse(e.content).text}function ec(e,t,c){var n=document.querySelectorAll(".content-div >p> span")[t];n&&"{"===e.content[0]&&(n.innerHTML=JSON.parse(e.content).html,c(!0))}var tc=function(){return Object(n.jsx)("div",{className:" user-container",children:Object(n.jsxs)("div",{className:"body-container",children:[Object(n.jsx)(cc,{}),Object(n.jsx)(Bt,{})]})})};function cc(e){var t=e.dynamic,c=void 0===t||t,a=Object(s.useState)(20),i=Object(l.a)(a,2),r=i[0],o=i[1],j=Object(s.useState)(q.getState().active||0),u=Object(l.a)(j,2),d=u[0],b=u[1];Object(s.useEffect)((function(){var e=q.subscribe((function(){return b(q.getState().active)}));return function(){return e()}})),Object(s.useEffect)((function(){o(30*d+20+40*d)}),[d]);var m=Object(s.useCallback)((function(e){q.dispatch({type:"activeSwitch",active:e})}),[]);return Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"user-main",children:[Object(n.jsxs)("ul",{className:"user-main-header",children:[Object(n.jsx)("li",{onClick:function(){return m(0)},children:"\u52a8\u6001"}),Object(n.jsx)("li",{onClick:function(){return m(1)},children:"\u56de\u7b54"}),Object(n.jsx)("li",{onClick:function(){return m(2)},children:"\u63d0\u95ee"}),Object(n.jsx)("li",{onClick:function(){return m(3)},children:"\u8d5e\u540c"}),Object(n.jsx)("li",{onClick:function(){return m(4)},children:"\u5173\u6ce8"}),Object(n.jsx)("li",{onClick:function(){return m(5)},children:"\u6536\u85cf"})]}),Object(n.jsx)("div",{className:"user-main-flag",style:{left:r+"px"}}),c&&Object(n.jsx)(nc,{active:d})]}),c&&Object(n.jsx)(Ye,{})]})}function nc(e){var t=Object(s.useState)(q.getState()||{}),c=Object(l.a)(t,2),a=c[0],i=c[1],r=a.userInfo,o=void 0===r?{}:r;return Object(s.useEffect)((function(){var e=q.subscribe((function(){return i(q.getState())}));return function(){return e()}}),[]),Object(n.jsxs)("div",{className:"dynamicList",children:[4!==e.active&&5!==e.active&&Object(n.jsx)("div",{className:"dynamic-head",children:Object(n.jsx)("span",{children:o.name===a.cookieUser?Object(n.jsxs)("span",{children:["\u6211\u7684",["\u52a8\u6001","\u56de\u7b54","\u63d0\u95ee","\u8d5e\u540c"][e.active]]}):Object(n.jsxs)("span",{children:["man"===o.sex?"\u4ed6":"\u5979","\u7684",["\u52a8\u6001","\u56de\u7b54","\u63d0\u95ee","\u8d5e\u540c"][e.active]]})})}),Object(n.jsx)("div",{children:Object(n.jsx)(sc,{active:e.active})})]})}function sc(e){var t=e.active,c=Object(s.useState)(q.getState()),a=Object(l.a)(c,2),i=a[0],r=a[1],o=i.attentionDynamic,j=void 0===o?[]:o,u=i.commentDynamic,d=void 0===u?[]:u,b=i.likeDynamic,m=void 0===b?[]:b,O=i.postDynamic,f=void 0===O?[]:O,h=i.collectComment,p=void 0===h?[]:h,x=i.collectQues,v=void 0===x?[]:x,g=Object(s.useState)(!0),y=Object(l.a)(g,2),C=y[0],k=y[1],N=[].concat(Object(kt.a)(j),Object(kt.a)(d),Object(kt.a)(m),Object(kt.a)(f),Object(kt.a)(p),Object(kt.a)(v)),I=[d,f,m,j,[].concat(Object(kt.a)(p),Object(kt.a)(v))];Object(s.useEffect)((function(){(i.attentionDynamic||i.commentDynamic||i.likeDynamic)&&k(!1)}),[i]),Object(s.useEffect)((function(){var e=q.subscribe((function(){return r(q.getState())}));return function(){return e()}}),[]);var S=C?new Array(6).fill(""):[];C||0!==t?C||0===t||(S=lc(I[t-1])):S=lc(N);var A=-1;return Object(n.jsx)(n.Fragment,{children:4===t?Object(n.jsx)(Gt,{dynamicList:S,state:i}):Object(n.jsxs)(n.Fragment,{children:[5===t&&Object(n.jsx)(Kt,{dynamicList:S,state:i}),4!==t&&5!==t&&Object(n.jsx)("ul",{className:"posts user-Dynamic",children:S.map((function(e,t){return"delete"!==e.status?(A++,Object(n.jsxs)(Fe.a,{loading:C,children:["comment"===e.style&&Object(n.jsx)(ac,{item:e,state:i,idx:A}),"post"===e.style&&Object(n.jsx)(ic,{item:e,state:i,idx:A}),"likeComment"===e.style&&Object(n.jsx)(rc,{item:e,state:i,idx:A}),"attention"===e.style&&Object(n.jsx)(oc,{item:e,state:i,idx:A}),"collect"===e.style&&Object(n.jsxs)(n.Fragment,{children:["question"===e.type&&Object(n.jsx)($t,{item:e,state:i,idx:A}),"comment"===e.type&&Object(n.jsx)(Xt,{item:e,state:i,idx:A})]})]},t)):""}))})]})})}function ac(e){var t=e.idx,c=e.state||{},a=c.userInfo,i=void 0===a?{}:a,r=e.item,o=i.avatar,j=1*(r.likeAt||r.createdAt),u=V()(j).endOf().fromNow(!0)+"\u524d",d=V()(1*r.createdAt).endOf().fromNow(!0)+"\u524d",b=Object(s.useState)(!1),m=Object(l.a)(b,2),O=m[0],f=m[1];return Object(s.useEffect)((function(){uc(r,t,f)}),[r]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"dynamicList-header",children:[Object(n.jsx)("span",{children:"\u56de\u7b54\u4e86\u95ee\u9898"}),Object(n.jsx)("span",{children:1*parseInt(u)>1&&/\u5929/g.test(u)?new Date(j).toLocaleDateString().slice(5):u})]}),Object(n.jsx)("div",{className:"content-div",name:"content",children:Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(r.postId),children:r.title})}),Object(n.jsxs)("div",{className:"commenter-info dynamic-comment",children:[Object(n.jsx)("i",{className:"commenter-avatar",style:{backgroundImage:"url(".concat(o,")")}}),Object(n.jsxs)("div",{className:"commenter-flag",children:[Object(n.jsx)(Q.b,{className:"commenter-name",to:".",children:i.name}),Object(n.jsx)("span",{className:"commenter-sign",children:i.sign}),Object(n.jsx)(He,{state:c,post:r,type:"comment"})]})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)("p",{children:Object(n.jsx)("span",{children:jc(r)})}),Object(n.jsxs)("span",{className:"answerAt",children:["\u53d1\u5e03\u4e8e \xa0",1*parseInt(d)>=1&&/\u5929/g.test(d)?V()(1*r.createdAt).format("YYYY-MM-DD HH:mm:ss"):d]}),Object(n.jsx)("div",{className:"commenter-footer",children:Object(n.jsx)(Me,{type:"comment",comment:r,idx:t,state:c,footer:O})})]})]},r.likeAt||r.createdAt)}function ic(e){var t=e.idx,c=e.state||{},a=Object(s.useState)(!1),i=Object(l.a)(a,2),r=i[0],o=i[1],j=e.item,u=1*(j.likeAt||j.createdAt),d=V()(u).endOf().fromNow(!0)+"\u524d";return Object(s.useEffect)((function(){uc(j,t,o)}),[j]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"dynamicList-header User-post-time",children:[Object(n.jsx)("span",{children:"\u53d1\u5e03\u4e86\u95ee\u9898"}),Object(n.jsxs)("span",{children:["\xa0\xa0:\xa0",1*parseInt(d)>1&&/\u5929/g.test(d)?V()(1*j.createdAt).format("YYYY-MM-DD HH:mm:ss"):d]}),Object(n.jsx)(He,{state:c,post:j,type:"post"})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(j.postId),children:j.title}),Object(n.jsx)("p",{className:"post-content",children:Object(n.jsx)("span",{children:jc(j)})})]}),Object(n.jsx)(Me,{type:"question",post:j,idx:t,state:c,footer:r})]},j.likeAt||j.createdAt)}function rc(e){var t=e.idx,c=e.state||{},a=e.item,i=a.avatar,r=1*(a.likeAt||a.createdAt),o=V()(r).endOf().fromNow(!0)+"\u524d",j=V()(1*a.createdAt).endOf().fromNow(!0)+"\u524d",u=Object(s.useState)(!1),d=Object(l.a)(u,2),b=d[0],m=d[1];return Object(s.useEffect)((function(){uc(a,t,m)}),[a]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"dynamicList-header",children:[Object(n.jsx)("span",{children:"\u8d5e\u540c\u4e86\u56de\u7b54"}),Object(n.jsx)("span",{children:1*parseInt(o)>1&&/\u5929/g.test(o)?new Date(r).toLocaleDateString().slice(5):o})]}),Object(n.jsx)("div",{className:"content-div",name:"content",children:Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(a.postId),children:a.title})}),Object(n.jsxs)("div",{className:"commenter-info dynamic-comment",children:[Object(n.jsx)("i",{className:"commenter-avatar",style:{backgroundImage:"url(".concat(i,")")}}),Object(n.jsxs)("div",{className:"commenter-flag",children:[Object(n.jsx)(Q.b,{className:"commenter-name",to:"/user/".concat(a.commenterId),children:a.name}),Object(n.jsx)("span",{className:"commenter-sign",children:a.sign}),Object(n.jsx)(He,{state:c,post:a,type:"comment"})]})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)("p",{className:"likeComment",children:Object(n.jsx)("span",{children:jc(a)})}),Object(n.jsxs)("span",{className:"answerAt",children:["\u53d1\u5e03\u4e8e  \xa0",1*parseInt(j)>=1&&/\u5929/g.test(j)?V()(1*a.createdAt).format("YYYY-MM-DD HH:mm:ss"):j]}),Object(n.jsx)("div",{className:"commenter-footer",children:Object(n.jsx)(Me,{type:"comment",comment:a,idx:t,state:c,footer:b})})]})]},a.likeAt||a.createdAt)}function oc(e){var t=e.idx,c=e.state||{},a=e.item,i=1*(a.likeAt||a.createdAt),r=V()(i).endOf().fromNow(!0)+"\u524d",o=Object(s.useState)(!1),j=Object(l.a)(o,2),u=j[0],d=j[1];return Object(s.useEffect)((function(){uc(a,t,d)}),[a]),Object(n.jsxs)("li",{children:[Object(n.jsxs)("div",{className:"dynamicList-header",children:[Object(n.jsx)("span",{children:"\u5173\u6ce8\u4e86\u95ee\u9898"}),Object(n.jsx)("span",{children:1*parseInt(r)>1&&/\u5929/g.test(r)?new Date(i).toLocaleDateString().slice(5):r})]}),Object(n.jsxs)("div",{className:"content-div",name:"content",children:[Object(n.jsx)(Q.b,{className:"post-title",to:"/post-page/".concat(a.postId),children:a.title}),Object(n.jsx)("p",{className:"post-content",children:Object(n.jsx)("span",{children:jc(a)})})]}),Object(n.jsx)(Me,{type:"question",post:a,idx:t,state:c,footer:u})]},a.likeAt||a.createdAt)}function lc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.from(e).sort((function(e,t){return(t.likeAt?1*t.likeAt:1*t.createdAt)-(e.likeAt?1*e.likeAt:1*e.createdAt)}))}function jc(e){if(e.content)return"{"!==e.content[0]?e.content:JSON.parse(e.content).text}function uc(e,t,c){var n=document.querySelectorAll(".content-div > p > span")[t];n&&"{"===e.content[0]&&(n.innerHTML=JSON.parse(e.content).html,c(!0))}var dc=function(){var e=Object(P.g)().id,t=Object(s.useState)(E.getState()),c=Object(l.a)(t,2),a=c[0],i=c[1];return Object(s.useEffect)((function(){var e=E.subscribe((function(){var e=E.getState(),t=e.posts,c=void 0===t?[]:t;i(e),q.dispatch({type:"getInitial",attention:e.attention,poors:e.poors,favoriteQues:e.favoriteQues,collect_quesActive:e.collect_quesActive,attentionDynamic:c.filter((function(e){return"attention"===e.style})),postDynamic:c.filter((function(e){return"post"===e.style})),collectQues:c.filter((function(e){return"collect"===e.style}))})}));return function(){return e()}}),[e]),Object(s.useEffect)((function(){if("undefined"!==e){C.a.get("/api/user-data/".concat(e)).then((function(e){var t=e.data;q.dispatch(Object(o.a)({type:"getInitial"},t)),E.dispatch(Object(o.a)(Object(o.a)({type:"getData"},t),{},{posts:[].concat(Object(kt.a)(t.postDynamic),Object(kt.a)(t.attentionDynamic),Object(kt.a)(t.collectQues))})),L.dispatch(Object(o.a)(Object(o.a)({type:"getInitial"},t),{},{commenterInfo:[].concat(Object(kt.a)(t.likeDynamic),Object(kt.a)(t.commentDynamic),Object(kt.a)(t.collectComment))}))}));var t=L.subscribe((function(){var e=L.getState();q.dispatch(Object(o.a)(Object(o.a)({type:"getInitial"},e),{},{favoriteComment:e.favoriteComment,collect_commActive:e.collect_commActive,likeDynamic:e.commenterInfo.filter((function(e){return"likeComment"===e.style})),commentDynamic:e.commenterInfo.filter((function(e){return"comment"===e.style})),collectComment:e.commenterInfo.filter((function(e){return"collect"===e.style}))}))}));return function(){return t()}}window.location.replace("/")}),[e]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(re,{page:"user",children:Object(n.jsx)(bc,{})}),a.question&&Object(n.jsx)(xe,{}),Object(n.jsx)(zt,{}),Object(n.jsx)(tc,{})]})};function bc(){var e=Object(s.useState)({}),t=Object(l.a)(e,2),c=t[0],a=t[1],i=c.userInfo||{};Object(s.useEffect)((function(){var e=q.subscribe((function(){return a(q.getState())}));return function(){return e()}}),[]);var r=Object(s.useCallback)((function(){q.dispatch({type:"editState",edit:!0})}),[]);return Object(n.jsxs)("div",{className:"user-ndv-slider",children:[Object(n.jsx)(cc,{dynamic:!1}),c.cookieUser===i.name?Object(n.jsx)("div",{className:"user-editing",onClick:r,children:"\u7f16\u8f91\u4e2a\u4eba\u8d44\u6599"}):Object(n.jsx)("div",{className:"other-user",children:Object(n.jsx)(ce,{careInfo:c.userInfo})})]})}var mc=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)(Q.a,{children:Object(n.jsxs)(P.d,{children:[Object(n.jsx)(P.b,{exact:!0,path:"/",children:Object(n.jsx)($e,{})}),Object(n.jsx)(P.b,{path:"/index",children:Object(n.jsx)($e,{})}),Object(n.jsx)(P.b,{path:"/sign",children:Object(n.jsx)(ct,{})}),Object(n.jsx)(P.b,{path:"/sign_up",children:Object(n.jsx)(ae,{})}),Object(n.jsx)(P.b,{path:"/post-page/:id",children:Object(n.jsx)(Ct,{})}),Object(n.jsx)(P.b,{path:"/user/:id",children:Object(n.jsx)(dc,{})}),Object(n.jsx)(P.a,{to:"/"})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c(308);var Oc=c(165),fc=c(15);V.a.locale("zh-cn"),r.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(fc.a,{locale:Oc.a,children:Object(n.jsx)(mc,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},77:function(e,t,c){}},[[319,1,2]]]);
//# sourceMappingURL=main.806b08ae.chunk.js.map